<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Add_task_to_update_list</name>
        <label>Add task to update list</label>
        <locationX>754</locationX>
        <locationY>2654</locationY>
        <assignmentItems>
            <assignToReference>tasksUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_tasks</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_tasks</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Cancel_task</name>
        <label>Cancel task</label>
        <locationX>754</locationX>
        <locationY>2546</locationY>
        <assignmentItems>
            <assignToReference>Loop_tasks.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_task_to_update_list</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Construct_non_presented_tasks_list</name>
        <label>Construct non-presented tasks list</label>
        <locationX>985</locationX>
        <locationY>1298</locationY>
        <assignmentItems>
            <assignToReference>taskTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>PORTAL_DOCS_UPLOAD</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>PORTAL_DOCS_UPLOAD_SEND_EMAIL</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>PORTAL_DOCS_UPLOAD_MIGRATION_4_EYE</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>PORTAL_DOCS_UPLOAD_MIGRATE</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_book_meeting_task_type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Construct_presented_tasks_list</name>
        <label>Construct presented tasks list</label>
        <locationX>721</locationX>
        <locationY>1298</locationY>
        <assignmentItems>
            <assignToReference>taskTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>BOOK_SUITABILITY_MEETING_AC</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>confirm_meeting</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_portal_docs_task_type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_2_of_Set_advice_type</name>
        <label>Set advice type</label>
        <locationX>1117</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>adviceType</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceTypeSelection.firstSelectedRow</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.AdviceType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceTypeSelection.firstSelectedRow.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>adviceUpdated</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Original_advice_method</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_advice_ID</name>
        <label>Set advice ID</label>
        <locationX>517</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>adviceId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_advice</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_advice_method_change</name>
        <label>Set advice method change</label>
        <locationX>820</locationX>
        <locationY>3422</locationY>
        <assignmentItems>
            <assignToReference>advice.AdviceMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceMethod</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_toast_values_success_deck_not_complete</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_book_meeting_task_type</name>
        <label>Set book meeting task type</label>
        <locationX>985</locationX>
        <locationY>1406</locationY>
        <assignmentItems>
            <assignToReference>taskTypeNew</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOOK_SUITABILITY_MEETING_AC</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_advice_tasks</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_fixed_advice_method</name>
        <label>Set fixed advice method</label>
        <locationX>853</locationX>
        <locationY>1814</locationY>
        <assignmentItems>
            <assignToReference>advice.AdviceMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>adviceType.AdviceMethod__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>adviceUpdated</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Updatescreen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_household_ID</name>
        <label>Set household ID</label>
        <locationX>517</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>householdId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Advice_given</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_portal_docs_task_type</name>
        <label>Set portal docs task type</label>
        <locationX>721</locationX>
        <locationY>1406</locationY>
        <assignmentItems>
            <assignToReference>taskTypeNew</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>PORTAL_DOCS_UPLOAD</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_advice_tasks</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_toast_values_advice_already_given</name>
        <label>Set toast values - advice already given</label>
        <locationX>50</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>toastVariant</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>error</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Advice already {!adviceMethodLowerCase} and cannot be updated</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastTitle</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Toast_screen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_toast_values_no_change</name>
        <label>Set toast values - no change</label>
        <locationX>1150</locationX>
        <locationY>2222</locationY>
        <assignmentItems>
            <assignToReference>toastVariant</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>info</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Advice still {!adviceMethodLowerCase}</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastTitle</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No change made</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Toast_screen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_toast_values_permission_error</name>
        <label>Set toast values - permission error</label>
        <locationX>1513</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>toastVariant</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>error</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>You do not have the permissions to update how advice is given</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastTitle</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Toast_screen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_toast_values_success_deck_not_complete</name>
        <label>Set toast values - success - deck not complete</label>
        <locationX>820</locationX>
        <locationY>3530</locationY>
        <assignmentItems>
            <assignToReference>toastVariant</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>success</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Advice now {!adviceMethodLowerCase}</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>toastTitle</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Success!</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_advice</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Advice_given</name>
        <label>Advice given?</label>
        <locationX>517</locationX>
        <locationY>566</locationY>
        <defaultConnector>
            <targetReference>Advice_type_defined</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not yet given</defaultConnectorLabel>
        <rules>
            <name>Already_given</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdvicePresented__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_toast_values_advice_already_given</targetReference>
            </connector>
            <label>Already given</label>
        </rules>
    </decisions>
    <decisions>
        <name>Advice_method_to_be_set</name>
        <label>Advice method to be set?</label>
        <locationX>985</locationX>
        <locationY>1706</locationY>
        <defaultConnector>
            <targetReference>Updatescreen</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Editable</defaultConnectorLabel>
        <rules>
            <name>Fixed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>adviceMethodRestricted</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>adviceType.AdviceMethod__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_fixed_advice_method</targetReference>
            </connector>
            <label>Fixed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Advice_type_defined</name>
        <label>Advice type defined?</label>
        <locationX>985</locationX>
        <locationY>674</locationY>
        <defaultConnector>
            <targetReference>Get_all_advice_types</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not defined</defaultConnectorLabel>
        <rules>
            <name>Defined</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceType__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_advice_type</targetReference>
            </connector>
            <label>Defined</label>
        </rules>
    </decisions>
    <decisions>
        <name>Changed</name>
        <label>Changed?</label>
        <locationX>985</locationX>
        <locationY>2114</locationY>
        <defaultConnector>
            <targetReference>Set_toast_values_no_change</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not changed</defaultConnectorLabel>
        <rules>
            <name>Changed_outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>AdviceMethod</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>adviceUpdated</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Deck_status</targetReference>
            </connector>
            <label>Changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Deck_status</name>
        <label>Deck status</label>
        <locationX>820</locationX>
        <locationY>2222</locationY>
        <defaultConnector>
            <targetReference>Set_advice_method_change</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not complete</defaultConnectorLabel>
        <rules>
            <name>Complete</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.DeckStatus__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Complete</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_tasks</targetReference>
            </connector>
            <label>Complete</label>
        </rules>
    </decisions>
    <decisions>
        <name>Original_advice_method</name>
        <label>Original advice method</label>
        <locationX>985</locationX>
        <locationY>1190</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Advice_method_to_be_set</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not known</defaultConnectorLabel>
        <rules>
            <name>Presented</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Construct_presented_tasks_list</targetReference>
            </connector>
            <label>Presented</label>
        </rules>
        <rules>
            <name>Non_presented</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>NON_PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Construct_non_presented_tasks_list</targetReference>
            </connector>
            <label>Non-presented</label>
        </rules>
    </decisions>
    <decisions>
        <name>Permitted_to_make_update</name>
        <label>Permitted to make update?</label>
        <locationX>1015</locationX>
        <locationY>134</locationY>
        <defaultConnector>
            <targetReference>Set_toast_values_permission_error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not permitted</defaultConnectorLabel>
        <rules>
            <name>Permitted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Permission.AdviceMethodControl</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_advice_ID</targetReference>
            </connector>
            <label>Permitted</label>
        </rules>
    </decisions>
    <decisions>
        <name>Task_open</name>
        <label>Task open</label>
        <locationX>886</locationX>
        <locationY>2438</locationY>
        <defaultConnector>
            <targetReference>Loop_tasks</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Closed</defaultConnectorLabel>
        <rules>
            <name>Open</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_tasks.IsClosed</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Cancel_task</targetReference>
            </connector>
            <label>Open</label>
        </rules>
    </decisions>
    <decisions>
        <name>Tasks_to_cancel</name>
        <label>Tasks to cancel?</label>
        <locationX>666</locationX>
        <locationY>2930</locationY>
        <defaultConnector>
            <targetReference>Create_new_task</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>tasksUpdate</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Cancel_tasks</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>Screen flow that walks a user through changing the advice method between presented and non-presented.</description>
    <dynamicChoiceSets>
        <name>AdviceMethodChoice</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true" />
        <object xsi:nil="true" />
        <picklistField>AdviceMethod__c</picklistField>
        <picklistObject>Advice__c</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <name>adviceMethodLowerCase</name>
        <dataType>String</dataType>
        <expression>CASE({!advice.AdviceMethod__c}, 
&quot;PRESENTED&quot;, &quot;presented&quot;,
&quot;NON_PRESENTED&quot;, &quot;non-presented&quot;,
&quot;unknown&quot;)</expression>
    </formulas>
    <formulas>
        <name>adviceMethodOtherLowerCase</name>
        <dataType>String</dataType>
        <expression>CASE({!advice.AdviceMethod__c}, 
&quot;PRESENTED&quot;, &quot;non-presented&quot;,
&quot;NON_PRESENTED&quot;, &quot;presented&quot;,
&quot;unknown&quot;)</expression>
    </formulas>
    <formulas>
        <name>adviceMethodRestricted</name>
        <dataType>Boolean</dataType>
        <expression>NOT(ISPICKVAL({!adviceType.AdviceMethod__c}, &quot;Any&quot;))</expression>
    </formulas>
    <formulas>
        <name>isAnnualReview</name>
        <dataType>Boolean</dataType>
        <expression>IF(ISBLANK({!advice.OW_review__c}), FALSE, TRUE)</expression>
    </formulas>
    <formulas>
        <name>isOnboarding</name>
        <dataType>Boolean</dataType>
        <expression>IF(ISPICKVAL({!advice.New_or_existing_client__c}, &quot;New&quot;), TRUE, FALSE)</expression>
    </formulas>
    <formulas>
        <name>taskDescription</name>
        <dataType>String</dataType>
        <expression>CASE({!advice.AdviceMethod__c},
&quot;PRESENTED&quot;, &quot;book the advice meeting&quot;,
&quot;NON_PRESENTED&quot;, &quot;share the advice on the portal&quot;,
&quot;give the advice&quot;)</expression>
    </formulas>
    <formulas>
        <name>taskDescriptionNew</name>
        <dataType>String</dataType>
        <expression>CASE({!advice.AdviceMethod__c},
&quot;PRESENTED&quot;, &quot;upload the advice to the portal&quot;,
&quot;NON_PRESENTED&quot;, &quot;book an advice meeting&quot;,
&quot;give the advice&quot;)</expression>
    </formulas>
    <interviewLabel>Advice | Advice Method Change {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Advice | Advice Method Change</label>
    <loops>
        <name>Loop_tasks</name>
        <label>Loop tasks</label>
        <locationX>666</locationX>
        <locationY>2330</locationY>
        <collectionReference>tasks</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Task_open</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Tasks_to_cancel</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>Get_advice</name>
        <label>Get advice</label>
        <locationX>517</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_household_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <object>Advice__c</object>
        <outputReference>advice</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Advice_Status__c</queriedFields>
        <queriedFields>AdviceMethod__c</queriedFields>
        <queriedFields>AdvicePresented__c</queriedFields>
        <queriedFields>DeckStatus__c</queriedFields>
        <queriedFields>Advice_Household__c</queriedFields>
        <queriedFields>AdviceType__c</queriedFields>
        <queriedFields>New_or_existing_client__c</queriedFields>
        <queriedFields>OW_review__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_advice_tasks</name>
        <label>Get advice tasks</label>
        <locationX>985</locationX>
        <locationY>1598</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Advice_method_to_be_set</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>WhatId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>adviceId</elementReference>
            </value>
        </filters>
        <filters>
            <field>FinServ__Household__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>householdId</elementReference>
            </value>
        </filters>
        <filters>
            <field>OW_task_information_name__c</field>
            <operator>In</operator>
            <value>
                <elementReference>taskTypes</elementReference>
            </value>
        </filters>
        <object>Task</object>
        <outputReference>tasks</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Status</queriedFields>
        <queriedFields>Type</queriedFields>
        <queriedFields>IsClosed</queriedFields>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_advice_type</name>
        <label>Get advice type</label>
        <locationX>853</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Original_advice_method</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.AdviceType__c</elementReference>
            </value>
        </filters>
        <object>AdviceType__c</object>
        <outputReference>adviceType</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>AdviceMethod__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_all_advice_types</name>
        <label>Get all advice types</label>
        <locationX>1117</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Confirm_advice_type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsOnboarding__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>isOnboarding</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsAnnualReview__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>isAnnualReview</elementReference>
            </value>
        </filters>
        <object>AdviceType__c</object>
        <outputReference>adviceTypes</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>Description__c</queriedFields>
        <queriedFields>AdviceMethod__c</queriedFields>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
    </recordLookups>
    <recordUpdates>
        <name>Cancel_tasks</name>
        <label>Cancel tasks</label>
        <locationX>534</locationX>
        <locationY>3038</locationY>
        <connector>
            <targetReference>Create_new_task</targetReference>
        </connector>
        <inputReference>tasksUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_advice</name>
        <label>Update advice</label>
        <locationX>820</locationX>
        <locationY>3638</locationY>
        <connector>
            <targetReference>Toast_screen</targetReference>
        </connector>
        <inputReference>advice</inputReference>
    </recordUpdates>
    <runInMode>SystemModeWithSharing</runInMode>
    <screens>
        <name>Confirm_advice_type</name>
        <label>Confirm advice type</label>
        <locationX>1117</locationX>
        <locationY>890</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Copy_2_of_Set_advice_type</targetReference>
        </connector>
        <fields>
            <name>AdviceTypeSelection</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>AdviceType__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Advice Type</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>SINGLE_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>1.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>shouldDisplayLabel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>adviceTypes</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isShowSearchBar</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>1.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-972e&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Advice Type Name&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Description__c&quot;,&quot;guid&quot;:&quot;column-eeb3&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Description&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <nextOrFinishButtonLabel>Confirm advice type</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Toast_screen</name>
        <label>Toast screen</label>
        <locationX>1015</locationX>
        <locationY>3998</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Toast</name>
            <extensionName>c:displayToastFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>variant</name>
                <value>
                    <elementReference>toastVariant</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>triggerNavigationNextEvent</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>title</name>
                <value>
                    <elementReference>toastTitle</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>message</name>
                <value>
                    <elementReference>toastMessage</elementReference>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Updatescreen</name>
        <label>Update screen</label>
        <locationX>985</locationX>
        <locationY>2006</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Changed</targetReference>
        </connector>
        <fields>
            <name>Updatescreen_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Updatescreen_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>AdviceMethod</name>
                    <choiceReferences>AdviceMethodChoice</choiceReferences>
                    <dataType>String</dataType>
                    <defaultValue>
                        <elementReference>advice.AdviceMethod__c</elementReference>
                    </defaultValue>
                    <fieldText>How will the client receive this advice?</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isDisabled>
                        <elementReference>adviceMethodRestricted</elementReference>
                    </isDisabled>
                    <isRequired>true</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <fields>
            <name>Updatescreen_Section2</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Updatescreen_Section2_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>TasksPrompt</name>
                    <fieldText>&lt;p&gt;The advice deck is already complete and tasks might be in progress to {!taskDescription}. Please talk with the task owners if anything is unclear to ensure this change is managed well with the client.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Any open tasks below will be closed and a new task will be created to &lt;span style=&quot;color: rgb(68, 68, 68); background-color: rgb(255, 255, 255);&quot;&gt;{!taskDescriptionNew}.&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                </fields>
                <fields>
                    <name>AdviceMethodChangeUnderstood</name>
                    <dataType>Boolean</dataType>
                    <defaultValue>
                        <booleanValue>false</booleanValue>
                    </defaultValue>
                    <fieldText>Change understood</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isDisabled>
                        <booleanValue>false</booleanValue>
                    </isDisabled>
                    <isRequired>true</isRequired>
                    <validationRule>
                        <errorMessage>&lt;p&gt;&lt;span style=&quot;color: rgb(255, 0, 0);&quot;&gt;Please tick to confirm you understand&lt;/span&gt;&lt;/p&gt;</errorMessage>
                        <formulaExpression>{!AdviceMethodChangeUnderstood}</formulaExpression>
                    </validationRule>
                </fields>
                <fields>
                    <name>TasksTable</name>
                    <dataTypeMappings>
                        <typeName>T</typeName>
                        <typeValue>Task</typeValue>
                    </dataTypeMappings>
                    <extensionName>flowruntime:datatable</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>label</name>
                        <value>
                            <stringValue>Data Table</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>selectionMode</name>
                        <value>
                            <stringValue>NO_SELECTION</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>minRowSelection</name>
                        <value>
                            <numberValue>0.0</numberValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>tableData</name>
                        <value>
                            <elementReference>tasks</elementReference>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>isShowSearchBar</name>
                        <value>
                            <booleanValue>true</booleanValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>columns</name>
                        <value>
                            <stringValue>[{&quot;apiName&quot;:&quot;Type&quot;,&quot;guid&quot;:&quot;column-3937&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Type&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Status&quot;,&quot;guid&quot;:&quot;column-ebf8&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Status&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>maxRowSelection</name>
                        <value>
                            <numberValue>0.0</numberValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>advice.DeckStatus__c</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Complete</stringValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>AdviceMethod</leftValueReference>
                    <operator>NotEqualTo</operator>
                    <rightValue>
                        <elementReference>advice.AdviceMethod__c</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <nextOrFinishButtonLabel>Update</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>889</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Permitted_to_make_update</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Create_new_task</name>
        <label>Create new task</label>
        <locationX>666</locationX>
        <locationY>3230</locationY>
        <connector>
            <targetReference>Set_advice_method_change</targetReference>
        </connector>
        <flowName>OW_task_create_from_task_information</flowName>
        <inputAssignments>
            <name>household_id</name>
            <value>
                <elementReference>householdId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>related_advice_id</name>
            <value>
                <elementReference>adviceId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>task_type</name>
            <value>
                <elementReference>taskTypeNew</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>what_id</name>
            <value>
                <elementReference>adviceId</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>advice</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Advice__c</objectType>
    </variables>
    <variables>
        <name>adviceId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>adviceType</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>AdviceType__c</objectType>
    </variables>
    <variables>
        <name>adviceTypes</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>AdviceType__c</objectType>
    </variables>
    <variables>
        <name>adviceUpdated</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>householdId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>The ID of the record being processed.</description>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Stores any tasks that will factor into a change of advice method.</description>
        <name>tasks</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>tasksUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>taskTypeNew</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>taskTypes</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>toastMessage</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>toastTitle</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>toastVariant</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
