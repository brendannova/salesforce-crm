<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>138</locationX>
        <locationY>1727</locationY>
        <assignmentItems>
            <assignToReference>recommendationsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_1_Needs_destination</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection2</name>
        <label>Add to collection</label>
        <locationX>50</locationX>
        <locationY>1295</locationY>
        <assignmentItems>
            <assignToReference>recommendationsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_recommendations_where_this_is_the_destination</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_cancel_regular_fulfilment_variables</name>
        <label>Assign cancel regular fulfilment variables</label>
        <locationX>578</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Advice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Advice__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Advice_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Checklist_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cancel existing regular</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Destination__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DestinationLegacy__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Expected_Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Household_lookup__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Initial_Fee_percent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Is_this_new_AuA__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>cancelregSearchName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Premium_Frequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>N/A</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_recommendation_type.FulfilmentRecordType__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Submit forms</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Suitability_Outcome_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Taken_Up__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>takenUp</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Top_Up_of_Existing__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Recommendation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Replacement_Policy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Phased__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>phased</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Initial_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Source__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.SourceLegacy__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.NewInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.NewInvestmentMandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.PreviousInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.PreviousInvestmentMandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Suitability_Outcome_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.EarliestFulfilmentDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>lastMonthDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.FulfilmentDeadline__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.FulfilmentDeadline__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_2_of_Create_fulfilment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_fulfilment_variables</name>
        <label>Assign fulfilment variables</label>
        <locationX>1238</locationX>
        <locationY>431</locationY>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Advice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Advice__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Advice_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Checklist_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.RecommendationTypeName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Destination__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DestinationLegacy__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Expected_Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Amount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Household_lookup__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Initial_Fee_percent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Is_this_new_AuA__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>isThisNewAuA</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>searchName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Premium_Frequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>N/A</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.RecommendationType__r.FulfilmentRecordType__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Suitability_Outcome_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Taken_Up__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>takenUp</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Top_Up_of_Existing__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>isThisATopUp</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Recommendation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Replacement_Policy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Phased__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>phased</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Initial_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Source__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.SourceLegacy__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.NewInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.NewInvestmentMandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.PreviousInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.PreviousInvestmentMandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Suitability_Outcome_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.EarliestFulfilmentDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.EarliestFulfilmentDate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.FulfilmentDeadline__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.FulfilmentDeadline__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Calculate_fulfilment_statusNotOpen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_fulfilment_variables_draft</name>
        <label>Assign fulfilment variables</label>
        <locationX>50</locationX>
        <locationY>863</locationY>
        <assignmentItems>
            <assignToReference>fulfilmentDraft.Advice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Advice__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentDraft.Recommendation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentDraft.Destination__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Calculate_fulfilment_status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_recommendation_updates</name>
        <label>Assign recommendation updates</label>
        <locationX>50</locationX>
        <locationY>1187</locationY>
        <assignmentItems>
            <assignToReference>recommendationToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToUpdate.DestinationLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collection2</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_regular_fulfilment_variables</name>
        <label>Assign regular fulfilment variables</label>
        <locationX>710</locationX>
        <locationY>431</locationY>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Advice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Advice__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Advice_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Checklist_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.RecommendationTypeName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Destination__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DestinationLegacy__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Expected_Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Amount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Household_lookup__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Initial_Fee_percent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Is_this_new_AuA__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>isThisNewAuA</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>searchName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Premium_Frequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>N/A</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.RecommendationType__r.FulfilmentRecordType__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Suitability_Outcome_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Taken_Up__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>takenUp</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Top_Up_of_Existing__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>isThisATopUp</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Recommendation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Replacement_Policy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Phased__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>phased</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Initial_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Source__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.SourceLegacy__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.NewInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.NewInvestmentMandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.PreviousInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.PreviousInvestmentMandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Suitability_Outcome_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.EarliestFulfilmentDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.EarliestFulfilmentDate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.FulfilmentDeadline__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.FulfilmentDeadline__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_1_of_Calculate_fulfilment_status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status</name>
        <label>Assign status</label>
        <locationX>1238</locationX>
        <locationY>647</locationY>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Calculate_fulfilment_statusNotOpen.status</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_fulfilment_pink</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_variables</name>
        <label>Assign variables</label>
        <locationX>138</locationX>
        <locationY>1619</locationY>
        <assignmentItems>
            <assignToReference>recommendationToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_1_Needs_destination.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToUpdate.DestinationLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_fee_variable</name>
        <label>Clear fee variable</label>
        <locationX>50</locationX>
        <locationY>3275</locationY>
        <assignmentItems>
            <assignToReference>feesToUpdate</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Get_fees_that_apply_to_this_product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_update_variable</name>
        <label>Clear update variable</label>
        <locationX>50</locationX>
        <locationY>2027</locationY>
        <assignmentItems>
            <assignToReference>recommendationsToUpdate</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Get_recommendations_where_this_is_the_source</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_1_of_Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>138</locationX>
        <locationY>2459</locationY>
        <assignmentItems>
            <assignToReference>recommendationsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_2_Needs_source</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_1_of_Assign_status</name>
        <label>Assign status</label>
        <locationX>710</locationX>
        <locationY>647</locationY>
        <assignmentItems>
            <assignToReference>fulfilmentToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Copy_1_of_Calculate_fulfilment_status.status</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_1_of_Create_fulfilment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_1_of_Assign_variables</name>
        <label>Assign variables</label>
        <locationX>138</locationX>
        <locationY>2351</locationY>
        <assignmentItems>
            <assignToReference>recommendationToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_2_Needs_source.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToUpdate.SourceLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_1_of_Add_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_2_of_Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>138</locationX>
        <locationY>2975</locationY>
        <assignmentItems>
            <assignToReference>feesToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>feeToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_3_Fee_from_here</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_2_of_Assign_variables</name>
        <label>Assign variables</label>
        <locationX>138</locationX>
        <locationY>2867</locationY>
        <assignmentItems>
            <assignToReference>feeToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Fee_from_here.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>feeToUpdate.TakenFromLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>feeToUpdate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>To be applied</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_2_of_Add_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_3_of_Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>138</locationX>
        <locationY>3707</locationY>
        <assignmentItems>
            <assignToReference>feesToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>feeToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_4_Fee_applies_here</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_3_of_Assign_variables</name>
        <label>Assign variables</label>
        <locationX>138</locationX>
        <locationY>3599</locationY>
        <assignmentItems>
            <assignToReference>feeToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_4_Fee_applies_here.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>feeToUpdate.AppliesToLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>feeToUpdate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>To be applied</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_3_of_Add_to_collection</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Is_there_an_end_date</name>
        <label>Is there an end date?</label>
        <locationX>710</locationX>
        <locationY>863</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesEnd</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RegularEndMonth__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_recommendation_type</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_this_a_transfer</name>
        <label>Is this a transfer?</label>
        <locationX>1238</locationX>
        <locationY>863</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecommendationType__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>External transfer in</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_fee</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>StatusOpen</name>
        <label>Status</label>
        <locationX>182</locationX>
        <locationY>431</locationY>
        <defaultConnectorLabel>Not taken up</defaultConnectorLabel>
        <rules>
            <name>Taken_up</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Accepted</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_OW_contact_details_id</targetReference>
            </connector>
            <label>Taken up</label>
        </rules>
    </decisions>
    <decisions>
        <name>What_type_of_recommendation_is_this</name>
        <label>What type of recommendation is this?</label>
        <locationX>710</locationX>
        <locationY>323</locationY>
        <defaultConnector>
            <targetReference>Assign_fulfilment_variables</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Open_product</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecommendationTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Open product</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>StatusOpen</targetReference>
            </connector>
            <label>Open product</label>
        </rules>
        <rules>
            <name>Regular</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecommendationTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Regular</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_regular_fulfilment_variables</targetReference>
            </connector>
            <label>Regular</label>
        </rules>
    </decisions>
    <description>A flow to create old process fulfilment for recommendations once taken up. Should be deactivated once all v2 fulfilment has been completed</description>
    <environments>Default</environments>
    <formulas>
        <name>bedISASearchName</name>
        <dataType>String</dataType>
        <expression>IF( ISNULL({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Bed&amp;ISA | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
 ISNULL({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline},
LEFT(&quot;By &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Bed&amp;ISA | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
NOT(ISNULL({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot; | Bed&amp;ISA | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
NOT(ISNULL({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline}, 
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot;, by &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Bed&amp;ISA | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), LEFT( &quot;Bed&amp;ISA | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80)
))))</expression>
    </formulas>
    <formulas>
        <name>bedSIPPSearchName</name>
        <dataType>String</dataType>
        <expression>IF( ISNULL({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Bed&amp;SIPP | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
 ISNULL({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline},
LEFT(&quot;By &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Bed&amp;SIPP | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
NOT(ISNULL({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot; | Bed&amp;SIPP | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
NOT(ISNULL({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline}, 
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot;, by &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Bed&amp;SIPP | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), LEFT( &quot;Bed&amp;SIPP | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80)
))))</expression>
    </formulas>
    <formulas>
        <name>cancelregSearchName</name>
        <dataType>String</dataType>
        <expression>&quot;Cancel regular | &quot;+ {!$Record.DestinationName__c}</expression>
    </formulas>
    <formulas>
        <name>changeRegSearchName</name>
        <dataType>String</dataType>
        <expression>&quot;Change to regular | &quot;+ {!$Record.DestinationName__c}</expression>
    </formulas>
    <formulas>
        <name>designationRegistrationNotes</name>
        <dataType>String</dataType>
        <expression>IF(ISPICKVAL({!$Record.DesignationType__c}, &quot;Revocable&quot;)||ISPICKVAL({!$Record.DesignationType__c}, &quot;Irrevocable&quot;), TEXT({!$Record.DesignationType__c}) + &quot; designation to &quot; + {!$Record.Designation__r.FirstName} + &quot; &quot; + {!$Record.Designation__r.LastName} + &quot;. &quot;, &quot;&quot;) + IF(NOT(ISBLANK({!$Record.RegisteredContact__c})), &quot;Registered contact &quot; + {!$Record.RegisteredContact__r.FirstName} + &quot; &quot; + {!$Record.RegisteredContact__r.LastName}, &quot;&quot;)</expression>
    </formulas>
    <formulas>
        <name>extTransferSearchName</name>
        <dataType>String</dataType>
        <expression>LEFT(&quot;Transfer &quot; + {!$Record.SourceLegacy__r.Public_Provider_Name__r.Name} + &quot; &quot; + {!$Record.SourceLegacy__r.FinServ__RecordTypeName__c} + &quot; to OW &quot; + IF(ISNULL({!$Record.DestinationLegacy__c}),{!$Record.PreRequisiteRecommendation__r.ProductName__c},{!$Record.DestinationLegacy__r.FinServ__RecordTypeName__c}) + &quot; | &quot; + IF(ISNULL({!$Record.DestinationLegacy__c}), {!$Record.PreRequisiteRecommendation__r.PrimaryClientName__c}, {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT({!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 1)), 80)</expression>
    </formulas>
    <formulas>
        <name>fulfilmentDeadline</name>
        <dataType>Date</dataType>
        <expression>IF(ISBLANK({!$Record.FulfilmentDeadline__c}), DATE(YEAR({!$Record.DateOfDecision__c})+1, MONTH({!$Record.DateOfDecision__c}), DAY({!$Record.DateOfDecision__c})), {!$Record.FulfilmentDeadline__c})</expression>
    </formulas>
    <formulas>
        <name>intTransferSearchName</name>
        <dataType>String</dataType>
        <expression>IF( ISNULL({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Internal transfer | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot; &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
 ISNULL({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline},
LEFT(&quot;By &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Internal transfer | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot; &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
NOT(ISNULL({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot; | Internal transfer | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot; &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), IF(
NOT(ISNULL({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline}, 
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot;, by &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Internal transfer | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot; &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80), LEFT( &quot;Internal transfer | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot; &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 80)
))))</expression>
    </formulas>
    <formulas>
        <name>isThisATopUp</name>
        <dataType>String</dataType>
        <expression>IF(ISPICKVAL({!$Record.Advice__r.New_or_existing_client__c}, &quot;New&quot;) &amp;&amp; {!$Record.RecommendationType__r.Name}=&quot;Lump sum&quot;, &quot;No&quot;, &quot;Yes&quot;)</expression>
    </formulas>
    <formulas>
        <name>isThisNewAuA</name>
        <dataType>String</dataType>
        <expression>IF( {!$Record.RecommendationType__r.Name} = &quot;Lump sum&quot;, &quot;Yes&quot;, &quot;No&quot;)</expression>
    </formulas>
    <formulas>
        <name>jointOwnerAddition</name>
        <dataType>String</dataType>
        <expression>IF( NOT(ISBLANK( {!$Record.PreRequisiteRecommendation__c} )), 
  IF( ISBLANK({!$Record.PreRequisiteRecommendation__r.JointOwner__c}), &quot;&quot;, 
    LEFT({!$Record.PreRequisiteRecommendation__r.JointOwner__r.FirstName}, 1)), 
  IF( ISBLANK({!$Record.DestinationLegacy__r.FinServ__JointOwner__c}), &quot;&quot;, 
    LEFT({!$Record.DestinationLegacy__r.FinServ__JointOwner__r.FirstName},1)
  )
)</expression>
    </formulas>
    <formulas>
        <name>lastMonthDate</name>
        <dataType>Date</dataType>
        <expression>DATE(IF( MONTH({!$Flow.CurrentDate}) &gt; {!lastMonthNum}, YEAR({!$Flow.CurrentDate}) + 1, YEAR({!$Flow.CurrentDate})), {!lastMonthNum}, {!$Setup.OW_business_configuration__c.IsaGiaRegularDay__c}) + 7</expression>
    </formulas>
    <formulas>
        <name>lastMonthNum</name>
        <dataType>Number</dataType>
        <expression>IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;January&quot;), 1,
  IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;February&quot;), 2,
    IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;March&quot;), 3,
      IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;April&quot;), 4,
        IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;May&quot;), 5,
          IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;June&quot;), 6,
            IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;July&quot;), 7,
              IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;August&quot;), 8,
                IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;September&quot;), 9,
                  IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;October&quot;), 10,
                    IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;November&quot;), 11,
                      IF( ISPICKVAL({!$Record.RegularEndMonth__c},&quot;December&quot;), 12, 0
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
    )  
  )
)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>lumpSearchName</name>
        <dataType>String</dataType>
        <expression>IF(ISPICKVAL({!$Record.PaidBy__c}, &quot;Employer&quot;), &quot;Employer &quot;, &quot;&quot;) +
IF( ISBLANK({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Lump sum | &quot; + {!standardSearchNameSuffix}, 80), IF(
 ISBLANK({!$Record.EarliestFulfilmentDate__c}) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline},
LEFT(&quot;By &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Lump sum | &quot; + {!standardSearchNameSuffix}, 80), IF(
NOT(ISBLANK({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; ({!$Record.FulfilmentDeadline__c}={!standardFulfilmentDeadline}),
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot; | Lump sum | &quot; + {!standardSearchNameSuffix}, 80), IF(
NOT(ISBLANK({!$Record.EarliestFulfilmentDate__c})) &amp;&amp; {!$Record.FulfilmentDeadline__c}!={!standardFulfilmentDeadline}, 
LEFT( &quot;Post &quot; + TEXT({!$Record.EarliestFulfilmentDate__c}) + &quot;, by &quot; + TEXT({!$Record.FulfilmentDeadline__c}) + &quot; | Lump sum | &quot; + {!standardSearchNameSuffix}, 80), LEFT( &quot;Lump sum | &quot; + {!standardSearchNameSuffix}, 80)
))))</expression>
    </formulas>
    <formulas>
        <name>openProductName</name>
        <dataType>String</dataType>
        <expression>LEFT(&quot;Open OW &quot; + {!$Record.ProductName__c} + &quot; | &quot; + {!$Record.PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT( {!$Record.PrimaryOwner__r.FirstName},1) + IF(ISBLANK({!$Record.JointOwner__c}), &quot;&quot;, &quot; &amp; &quot; + LEFT({!$Record.JointOwner__r.FirstName}, 1)) + IF(NOT(ISBLANK({!$Record.Designation__c})), &quot;| Designated to &quot; + {!$Record.Designation__r.FirstName}, &quot;&quot;),80)</expression>
    </formulas>
    <formulas>
        <name>phased</name>
        <dataType>String</dataType>
        <expression>IF( ISPICKVAL({!$Record.PhasingFrequency__c}, &quot;Single&quot;), &quot;No&quot;, &quot;Yes&quot;)</expression>
    </formulas>
    <formulas>
        <name>portalDisplayType</name>
        <dataType>String</dataType>
        <expression>IF( {!$Record.Product__r.Name}= &quot;ISA&quot;, &quot;Stocks &amp; Shares ISA&quot;, 
IF( {!$Record.Product__r.Name}= &quot;GIA&quot;, &quot;General Investment Account&quot;,
IF( {!$Record.Product__r.Name}= &quot;Junior SIPP&quot;, &quot;Defined Contribution&quot;,
IF( {!$Record.Product__r.Name}= &quot;SIPP&quot;, &quot;Defined Contribution&quot;,
IF( {!$Record.Product__r.Name}=&quot;Junior ISA&quot;, &quot;Junior ISA&quot;, &quot;&quot;)))))</expression>
    </formulas>
    <formulas>
        <name>rebalanceSearchName</name>
        <dataType>String</dataType>
        <expression>LEFT(&quot;Rebalance | &quot; + {!standardSearchNameSuffix}, 80)</expression>
    </formulas>
    <formulas>
        <name>regularSearchName</name>
        <dataType>String</dataType>
        <expression>&quot;Regular to &quot; + {!standardSearchNameSuffix}</expression>
    </formulas>
    <formulas>
        <name>searchName</name>
        <dataType>String</dataType>
        <expression>IF( {!$Record.RecommendationType__r.Name} = &quot;Rebalance&quot;, {!rebalanceSearchName},
  IF ( {!$Record.RecommendationType__r.Name} = &quot;Portfolio switch&quot;, {!switchSearchName},
 IF ( {!$Record.RecommendationType__r.Name} = &quot;Cancel existing regular&quot;, {!cancelregSearchName},
 IF ( {!$Record.RecommendationType__r.Name} = &quot;Change existing regular&quot;, {!changeRegSearchName},
    IF( {!$Record.RecommendationType__r.Name} = &quot;Rebalance&quot;, {!rebalanceSearchName},
      IF( {!$Record.RecommendationType__r.Name} = &quot;Open product&quot;,  {!openProductName}, 
        IF( {!$Record.RecommendationType__r.Name} = &quot;External transfer in&quot;,  {!extTransferSearchName}, 
          IF( {!$Record.RecommendationType__r.Name} = &quot;Regular&quot;,  {!regularSearchName}, 
            IF ( {!$Record.DestinationLegacy__r.FinServ__RecordTypeName__c} = &quot;SIPP&quot;&amp;&amp;{!$Record.RecommendationType__r.Name}=&quot;Internal transfer&quot;, {!bedSIPPSearchName}, 
              IF ( ({!$Record.DestinationLegacy__r.FinServ__RecordTypeName__c} = &quot;Stocks &amp; Shares ISA&quot;||{!$Record.DestinationLegacy__r.FinServ__RecordTypeName__c} = &quot;Junior ISA&quot;)&amp;&amp;{!$Record.RecommendationType__r.Name}=&quot;Internal transfer&quot;, {!bedISASearchName},
IF( {!$Record.RecommendationType__r.Name} = &quot;Internal transfer&quot;, {!intTransferSearchName},
{!lumpSearchName}
)))))))))))</expression>
    </formulas>
    <formulas>
        <name>standardFulfilmentDeadline</name>
        <dataType>Date</dataType>
        <expression>DATE(YEAR({!$Record.DateOfDecision__c})+1, MONTH({!$Record.DateOfDecision__c}), DAY({!$Record.DateOfDecision__c}))</expression>
    </formulas>
    <formulas>
        <name>standardSearchNameSuffix</name>
        <dataType>String</dataType>
        <expression>&quot;OW &quot; + IF( ISNULL({!$Record.DestinationLegacy__c}), {!$Record.PreRequisiteRecommendation__r.ProductName__c} + &quot; | &quot; +{!$Record.PreRequisiteRecommendation__r.PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT({!$Record.PreRequisiteRecommendation__r.PrimaryOwner__r.FirstName}, 1) + {!jointOwnerAddition},
{!$Record.DestinationLegacy__r.FinServ__RecordTypeName__c} + &quot; | &quot; +{!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT({!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 1) + {!jointOwnerAddition})</expression>
    </formulas>
    <formulas>
        <name>status</name>
        <dataType>String</dataType>
        <expression>IF( ISPICKVAL({!$Record.Status__c}, &quot;Declined&quot;), &quot;Not taken up&quot;, IF( ({!$Record.EarliestFulfilmentDate__c} &lt;= {!$Flow.CurrentDate}) || ISBLANK({!$Record.EarliestFulfilmentDate__c}), &quot;Submit forms&quot;, &quot;On hold&quot;))</expression>
    </formulas>
    <formulas>
        <name>switchSearchName</name>
        <dataType>String</dataType>
        <expression>LEFT(&quot;Switch to &quot;  + TEXT({!$Record.NewInvestmentMandate__c}) + &quot; | &quot; + {!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT({!$Record.DestinationLegacy__r.FinServ__PrimaryOwner__r.FirstName}, 1) + &quot; | &quot; + TEXT({!$Record.DestinationLegacy__r.Subtype__c}), 80)</expression>
    </formulas>
    <formulas>
        <name>takenUp</name>
        <dataType>String</dataType>
        <expression>IF( ISPICKVAL({!$Record.Status__c}, &quot;Accepted&quot;), &quot;Yes&quot;, &quot;No&quot;)</expression>
    </formulas>
    <interviewLabel>Recommendation - decision made {!$Flow.CurrentDateTime}</interviewLabel>
    <label>zOLD PROCESS Recommendation - decision made</label>
    <loops>
        <name>Loop_1_Needs_destination</name>
        <label>Loop 1 | Needs destination</label>
        <locationX>50</locationX>
        <locationY>1511</locationY>
        <collectionReference>Get_recommendations_where_this_is_the_destination</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_variables</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_recommendations2</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_2_Needs_source</name>
        <label>Loop 2 | Needs source</label>
        <locationX>50</locationX>
        <locationY>2243</locationY>
        <collectionReference>Get_recommendations_where_this_is_the_source</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Copy_1_of_Assign_variables</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_fees_to_be_taken_from_this_product</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_3_Fee_from_here</name>
        <label>Loop 3 | Fee from here</label>
        <locationX>50</locationX>
        <locationY>2759</locationY>
        <collectionReference>Get_fees_to_be_taken_from_this_product</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Copy_2_of_Assign_variables</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Copy_1_of_Update_fees</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_4_Fee_applies_here</name>
        <label>Loop 4 | Fee applies here</label>
        <locationX>50</locationX>
        <locationY>3491</locationY>
        <collectionReference>Get_fees_that_apply_to_this_product</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Copy_3_of_Assign_variables</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_fees</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Copy_1_of_Create_fulfilment</name>
        <label>Create fulfilment</label>
        <locationX>710</locationX>
        <locationY>755</locationY>
        <connector>
            <targetReference>Is_there_an_end_date</targetReference>
        </connector>
        <inputReference>fulfilmentToCreate</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Copy_2_of_Create_fulfilment</name>
        <label>Create fulfilment</label>
        <locationX>578</locationX>
        <locationY>1187</locationY>
        <inputReference>fulfilmentToCreate</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_financial_product</name>
        <label>Create financial product</label>
        <locationX>50</locationX>
        <locationY>755</locationY>
        <assignRecordIdToReference>productId</assignRecordIdToReference>
        <connector>
            <targetReference>Assign_fulfilment_variables_draft</targetReference>
        </connector>
        <inputAssignments>
            <field>FinServ__Household__c</field>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FinServ__JointOwner__c</field>
            <value>
                <elementReference>$Record.JointOwner__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FinServ__PrimaryOwner__c</field>
            <value>
                <elementReference>$Record.PrimaryOwner__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FinServ__Status__c</field>
            <value>
                <stringValue>Pending Fulfilment</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Household__c</field>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Internal_Notes__c</field>
            <value>
                <elementReference>designationRegistrationNotes</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OW_Investment_Mandate__c</field>
            <value>
                <elementReference>$Record.NewInvestmentMandate__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OW_stop_internal_change_processing__c</field>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Provider_Contact_Details__c</field>
            <value>
                <elementReference>Get_OW_contact_details_id.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Public_Provider_Name__c</field>
            <value>
                <elementReference>Get_OW_record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>$Record.Product__r.LegacyFinancialProductRecordTypeId__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subtype__c</field>
            <value>
                <elementReference>portalDisplayType</elementReference>
            </value>
        </inputAssignments>
        <object>FinServ__FinancialAccount__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_fulfilment</name>
        <label>Create fulfilment</label>
        <locationX>50</locationX>
        <locationY>1079</locationY>
        <connector>
            <targetReference>Assign_recommendation_updates</targetReference>
        </connector>
        <inputAssignments>
            <field>Advice_Fee__c</field>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Advice__c</field>
            <value>
                <elementReference>$Record.Advice__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Checklist_Type__c</field>
            <value>
                <stringValue>Open product</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Destination__c</field>
            <value>
                <elementReference>productId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Household_lookup__c</field>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_this_new_AuA__c</field>
            <value>
                <stringValue>No</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>searchName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>NewInvestmentMandate__c</field>
            <value>
                <elementReference>$Record.NewInvestmentMandate__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Premium_Frequency__c</field>
            <value>
                <stringValue>N/A</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Recommendation__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>$Record.RecommendationType__r.FulfilmentRecordType__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Replacement_Policy__c</field>
            <value>
                <stringValue>Yes</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <elementReference>Calculate_fulfilment_status.status</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Suitability_Outcome_Complete__c</field>
            <value>
                <elementReference>$Record.DateOfDecision__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Taken_Up__c</field>
            <value>
                <stringValue>Yes</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Top_Up_of_Existing__c</field>
            <value>
                <stringValue>No</stringValue>
            </value>
        </inputAssignments>
        <object>Fulfillment__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_fulfilment_pink</name>
        <label>Create fulfilment</label>
        <locationX>1238</locationX>
        <locationY>755</locationY>
        <connector>
            <targetReference>Is_this_a_transfer</targetReference>
        </connector>
        <inputReference>fulfilmentToCreate</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_fee</name>
        <label>Get fee</label>
        <locationX>1106</locationX>
        <locationY>1079</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Create_apply_fee_task</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AppliesToRecommendation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Fee__c</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_fees_that_apply_to_this_product</name>
        <label>Get fees that apply to this product</label>
        <locationX>50</locationX>
        <locationY>3383</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_4_Fee_applies_here</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AppliesToRecommendation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Fee__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_fees_to_be_taken_from_this_product</name>
        <label>Get fees to be taken from this product</label>
        <locationX>50</locationX>
        <locationY>2651</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_3_Fee_from_here</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>TakenFromRecommendation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Fee__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_OW_contact_details_id</name>
        <label>Get OW contact details id</label>
        <locationX>50</locationX>
        <locationY>539</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_OW_record</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Provider_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Octopus Wealth</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Provider_Database__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_OW_record</name>
        <label>Get OW record</label>
        <locationX>50</locationX>
        <locationY>647</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Create_financial_product</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Octopus Wealth</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Public_Provider_Names__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_recommendation_type</name>
        <label>Get recommendation type</label>
        <locationX>578</locationX>
        <locationY>971</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_cancel_regular_fulfilment_variables</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Cancel existing regular</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecommendationType__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_recommendations_where_this_is_the_destination</name>
        <label>Get recommendations where this is the destination</label>
        <locationX>50</locationX>
        <locationY>1403</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_1_Needs_destination</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>PreRequisiteRecommendation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Recommendation__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_recommendations_where_this_is_the_source</name>
        <label>Get recommendations where this is the source</label>
        <locationX>50</locationX>
        <locationY>2135</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_2_Needs_source</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>PreRequisiteRecommendationSource__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Recommendation__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Copy_1_of_Update_fees</name>
        <label>Update fees</label>
        <locationX>50</locationX>
        <locationY>3167</locationY>
        <connector>
            <targetReference>Clear_fee_variable</targetReference>
        </connector>
        <inputReference>feesToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_fee</name>
        <label>Update fee</label>
        <locationX>1106</locationX>
        <locationY>971</locationY>
        <connector>
            <targetReference>Get_fee</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AppliesToRecommendation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>To be applied</stringValue>
            </value>
        </inputAssignments>
        <object>Fee__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_fees</name>
        <label>Update fees</label>
        <locationX>50</locationX>
        <locationY>3899</locationY>
        <connector>
            <targetReference>Update_recommendations</targetReference>
        </connector>
        <inputReference>feesToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_recommendations</name>
        <label>Update recommendations</label>
        <locationX>50</locationX>
        <locationY>4007</locationY>
        <inputReference>recommendationsToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_recommendations2</name>
        <label>Update recommendations</label>
        <locationX>50</locationX>
        <locationY>1919</locationY>
        <connector>
            <targetReference>Clear_update_variable</targetReference>
        </connector>
        <inputReference>recommendationsToUpdate</inputReference>
    </recordUpdates>
    <start>
        <locationX>584</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>What_type_of_recommendation_is_this</targetReference>
        </connector>
        <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Accepted</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Declined</stringValue>
            </value>
        </filters>
        <object>Recommendation__c</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Draft</status>
    <subflows>
        <name>Calculate_fulfilment_status</name>
        <label>Calculate fulfilment status</label>
        <locationX>50</locationX>
        <locationY>971</locationY>
        <connector>
            <targetReference>Create_fulfilment</targetReference>
        </connector>
        <flowName>FulfilmentCalculateStatus</flowName>
        <inputAssignments>
            <name>fulfilment</name>
            <value>
                <elementReference>fulfilmentDraft</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Calculate_fulfilment_statusNotOpen</name>
        <label>Calculate fulfilment status</label>
        <locationX>1238</locationX>
        <locationY>539</locationY>
        <connector>
            <targetReference>Assign_status</targetReference>
        </connector>
        <flowName>FulfilmentCalculateStatus</flowName>
        <inputAssignments>
            <name>fulfilment</name>
            <value>
                <elementReference>fulfilmentToCreate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>recStatus</name>
            <value>
                <elementReference>$Record.Status__c</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Copy_1_of_Calculate_fulfilment_status</name>
        <label>Calculate fulfilment status</label>
        <locationX>710</locationX>
        <locationY>539</locationY>
        <connector>
            <targetReference>Copy_1_of_Assign_status</targetReference>
        </connector>
        <flowName>FulfilmentCalculateStatus</flowName>
        <inputAssignments>
            <name>fulfilment</name>
            <value>
                <elementReference>fulfilmentToCreate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>recStatus</name>
            <value>
                <elementReference>$Record.Status__c</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Create_apply_fee_task</name>
        <label>Create apply fee task</label>
        <locationX>1106</locationX>
        <locationY>1187</locationY>
        <flowName>OW_task_create_from_task_information</flowName>
        <inputAssignments>
            <name>household_id</name>
            <value>
                <elementReference>$Record.Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>task_type</name>
            <value>
                <stringValue>submit_transfer_fee</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>what_id</name>
            <value>
                <elementReference>Create_fulfilment</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>relatedFee</name>
            <value>
                <elementReference>Get_fee.Id</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>feeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>feesToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Fee__c</objectType>
    </variables>
    <variables>
        <name>feeToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Fee__c</objectType>
    </variables>
    <variables>
        <name>fuflilmentId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>fulfilmentDraft</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Fulfillment__c</objectType>
    </variables>
    <variables>
        <name>fulfilmentToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Fulfillment__c</objectType>
    </variables>
    <variables>
        <name>productId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recommendationsToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>recommendationToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
</Flow>
