<template>
    <!-- Error display -->
    <template if:true={state.error}>
        <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_error" role="alert">
            <span class="slds-assistive-text">error</span>
            <lightning-icon icon-name="utility:error" alternative-text="Error" size="x-small" class="slds-m-right_x-small"></lightning-icon>
            <h2>{state.error}</h2>
        </div>
    </template>
    
    <!-- Related List -->
    <template if:true={state.showRelatedList}>
        <lightning-card>
            <!-- Related List Header -->
            <div slot="title" class="slds-media slds-media_center">
                <div class="slds-media__figure">
                    <lightning-icon icon-name={state.iconName} size="small"></lightning-icon>
                </div>
                <div class="slds-media__body">
                    <span>{state.title}</span>
                </div>
            </div>
            
            <div slot="actions">
                <lightning-button-icon 
                    icon-name="utility:refresh" 
                    variant="bare" 
                    size="small" 
                    title="Refresh"
                    onclick={handleRefreshData}>
                </lightning-button-icon>
            </div>
            
            <!-- Related List Body -->
            <template if:true={hasRows}>
                <div class="slds-table_header-fixed_container">
                    <div class="slds-scrollable_y" style={heightStyle}>
                        <lightning-datatable 
                            columns={state.columns}
                            data={state.rows}
                            key-field={state.keyField}
                            hide-checkbox-column={hideCheckboxColumn}
                            show-row-number-column
                            onrowselection={handleRowSelection}
                            onrowaction={handleRowAction}
                            max-row-selection={maxRowSelectionValue}>
                        </lightning-datatable>
                    </div>
                </div>
            </template>
            <template if:false={hasRows}>
                <div class="slds-text-align_center slds-p-vertical_medium">
                    <p class="slds-text-body_small slds-text-color_weak">No records found</p>
                </div>
            </template>
        </lightning-card>
    </template>
</template>