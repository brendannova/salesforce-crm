<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>StageWonTermsMustBeSigned</fullName>
    <active>true</active>
    <description>Ensures that an opportunity is not marked as won until terms of business are accepted. Applies to advice opportunities only, discovery and fast track.</description>
    <errorConditionFormula>!$Setup.SystemConfiguration__c.ValidationBypass__c
&amp;&amp;
IsWon
&amp;&amp;
NOT(ISPICKVAL(Account.OW_terms_of_Business_Status__c, &quot;Accepted&quot; ))
&amp;&amp;
( RecordType.DeveloperName = &quot;Advice_Opportunity&quot; ||
RecordType.DeveloperName = &quot;AdviceFastTrack&quot; )</errorConditionFormula>
    <errorDisplayField>StageName</errorDisplayField>
    <errorMessage>An opportunity can only be won when a client in the household has accepted terms of business.</errorMessage>
</ValidationRule>
