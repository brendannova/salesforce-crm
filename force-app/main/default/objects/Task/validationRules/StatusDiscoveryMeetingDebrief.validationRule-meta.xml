<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>StatusDiscoveryMeetingDebrief</fullName>
    <active>true</active>
    <description>Cannot be marked as complete unless related opportunity has been updated with discovery meeting debrief details</description>
    <errorConditionFormula>!$Setup.SystemConfiguration__c.ValidationBypass__c &amp;&amp;
AND(
RecordType.DeveloperName = &quot;Discovery_Meeting_Debrief&quot;, 
ISPICKVAL(Status, &quot;Completed&quot;), 
OR(
ISBLANK(Related_Opportunity__r.List_of_LOAs_status__c ), 
ISBLANK( Related_Opportunity__r.Opportunity_Initial_Fee_amount__c),
ISPICKVAL( Related_Opportunity__r.Opportunity_Initial_Fee__c,&quot;&quot; ), 
ISPICKVAL(  Related_Opportunity__r.Qualification_Confirmation__c ,&quot;&quot; ),
Related_Opportunity__r.Client_Vulnerability_Updated__c = false,

AND(
ISPICKVAL(  Related_Opportunity__r.Qualification_Confirmation__c ,&quot;Not Qualified&quot; ), 
 ISBLANK(Related_Opportunity__r.Not_Qualified_Reason__c)
)
)
)</errorConditionFormula>
    <errorMessage>You need to complete the Discovery Meeting Debrief on the Opportunity</errorMessage>
</ValidationRule>
