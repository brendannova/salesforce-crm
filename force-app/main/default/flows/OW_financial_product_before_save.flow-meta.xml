<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>53.0</apiVersion>
    <assignments>
        <name>Clear_ownership</name>
        <label>Clear ownership</label>
        <locationX>722</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>$Record.FinServ__Ownership__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Decision_Set_Hubwise_Integration_Fields</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_household</name>
        <label>Populate household</label>
        <locationX>326</locationX>
        <locationY>1403</locationY>
        <assignmentItems>
            <assignToReference>$Record.Household__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.FinServ__PrimaryOwner__r.Household_Lookup__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.FinServ__Household__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.FinServ__PrimaryOwner__r.Household_Lookup__r.Household_Lookup__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Determine_ownership</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_direct_holding_name</name>
        <label>Set direct holding name</label>
        <locationX>326</locationX>
        <locationY>1103</locationY>
        <assignmentItems>
            <assignToReference>$Record.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>{!$Record.Company_Name__c} Direct Holding</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Household_null</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Hubwise_Integration_Values</name>
        <label>Set Hubwise Integration Values</label>
        <locationX>326</locationX>
        <locationY>2003</locationY>
        <assignmentItems>
            <assignToReference>$Record.IntegrationSource__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>HUBWISE</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.IntegrationStatus__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>ACTIVE</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Product_group</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_name_of_FP</name>
        <label>Set name of FP</label>
        <locationX>590</locationX>
        <locationY>1103</locationY>
        <assignmentItems>
            <assignToReference>$Record.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>nameCapped</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Household_null</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_New_Record_Type_ID</name>
        <label>Set New Record Type ID &amp; Portal Display Type</label>
        <locationX>326</locationX>
        <locationY>503</locationY>
        <assignmentItems>
            <assignToReference>$Record.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>RecordTypeIDSpecifiedByFinancialProductType</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Does_FP_Portal_Display_Type_match_FPT_Portal_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_ownership_to_individual</name>
        <label>Set ownership to individual</label>
        <locationX>194</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>$Record.FinServ__Ownership__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Individual</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Decision_Set_Hubwise_Integration_Fields</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_ownership_to_joint</name>
        <label>Set ownership to joint</label>
        <locationX>458</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>$Record.FinServ__Ownership__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Joint</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Decision_Set_Hubwise_Integration_Fields</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets the product group to a value of account</description>
        <name>Set_product_group_to_account</name>
        <label>Set product group to account</label>
        <locationX>62</locationX>
        <locationY>2303</locationY>
        <assignmentItems>
            <assignToReference>$Record.OW_product_group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Account</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_this_a_pre_LOA_DB</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets the product group to a value of protection</description>
        <name>Set_product_group_to_protection</name>
        <label>Set product group to protection</label>
        <locationX>590</locationX>
        <locationY>2303</locationY>
        <assignmentItems>
            <assignToReference>$Record.OW_product_group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Protection</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <description>Sets the product group to a value of trust</description>
        <name>Set_product_group_to_trust</name>
        <label>Set product group to trust</label>
        <locationX>326</locationX>
        <locationY>2303</locationY>
        <assignmentItems>
            <assignToReference>$Record.OW_product_group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Trust</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_this_a_pre_LOA_DB</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets the product group to a value of uncategorised</description>
        <name>Set_product_group_to_uncategorised</name>
        <label>Set product group to uncategorised</label>
        <locationX>854</locationX>
        <locationY>2303</locationY>
        <assignmentItems>
            <assignToReference>$Record.OW_product_group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Uncategorised</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <description>Sets the value of financial product not taken up to a blank value.</description>
        <name>Set_value_to_null</name>
        <label>Set value to null</label>
        <locationX>490</locationX>
        <locationY>3203</locationY>
        <assignmentItems>
            <assignToReference>$Record.FP_Value__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
    </assignments>
    <assignments>
        <description>Sets the value of the now closed financial product to zero.</description>
        <name>Set_value_to_zero</name>
        <label>Set value to zero</label>
        <locationX>50</locationX>
        <locationY>3311</locationY>
        <assignmentItems>
            <assignToReference>$Record.FP_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Update_Portal_Display_Type</name>
        <label>Update Portal Display Type</label>
        <locationX>326</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Subtype__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.FinancialProductType__r.PortalName__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Naming_required</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>PB-5332: If certain criteria are matched, set fields to appropriate values for Nova service to pick this product up to sync with hubwise</description>
        <name>Decision_Set_Hubwise_Integration_Fields</name>
        <label>Set Hubwise Integration Fields?</label>
        <locationX>458</locationX>
        <locationY>1895</locationY>
        <defaultConnector>
            <targetReference>Product_group</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Change</defaultConnectorLabel>
        <rules>
            <name>Rule_Set_Hubwise_Integration_Fields</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.BusinessType__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New business</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Public_Provider_Name__r.OW_own_company__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Hubwise_Integration_Values</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Set Hubwise Integration Values</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines if the ownership of this financial product is primary or joint and sets appropriately.</description>
        <name>Determine_ownership</name>
        <label>Determine ownership</label>
        <locationX>458</locationX>
        <locationY>1595</locationY>
        <defaultConnector>
            <targetReference>Clear_ownership</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Individual</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FinServ__PrimaryOwner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinServ__JointOwner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_ownership_to_individual</targetReference>
            </connector>
            <label>Individual</label>
        </rules>
        <rules>
            <name>Joint</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FinServ__PrimaryOwner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinServ__JointOwner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_ownership_to_joint</targetReference>
            </connector>
            <label>Joint</label>
        </rules>
    </decisions>
    <decisions>
        <name>Do_we_have_their_NI_number</name>
        <label>Do we have their NI number?</label>
        <locationX>304</locationX>
        <locationY>2711</locationY>
        <defaultConnector>
            <targetReference>Status</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_NI</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FinServ__PrimaryOwner__r.National_Insurance_Number__pc</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_policy_number_as_NI</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_financial_product_have_a_value</name>
        <label>Does financial product have a value?</label>
        <locationX>182</locationX>
        <locationY>3203</locationY>
        <defaultConnectorLabel>No value is 0 or null</defaultConnectorLabel>
        <rules>
            <name>Value_greater_than_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FP_Value__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_value_to_zero</targetReference>
            </connector>
            <label>Value greater than 0</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if the record type matches for the new financial product type</description>
        <name>Does_FP_and_FPT_Record_Type_Developer_Name_Match</name>
        <label>Does FP and FPT Record Type Developer Name Match?</label>
        <locationX>458</locationX>
        <locationY>287</locationY>
        <defaultConnector>
            <targetReference>Does_FP_Portal_Display_Type_match_FPT_Portal_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Matches</defaultConnectorLabel>
        <rules>
            <name>Does_Not_Match</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record.FinancialProductType__r.FinancialProductRecordTypeDeveloperName__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinancialProductType__r.FinancialProductRecordTypeDeveloperName__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Record_Type_ID_From_Developer_Name</targetReference>
            </connector>
            <label>Does Not Match</label>
        </rules>
    </decisions>
    <decisions>
        <description>Does the financial product portal display type match that on the selected Financial Product Type?
This field is not used by the portal anymore but is built into a lot of systems so needs to be unpicked!</description>
        <name>Does_FP_Portal_Display_Type_match_FPT_Portal_Type</name>
        <label>Does FP Portal Display Type match FPT Portal Type</label>
        <locationX>458</locationX>
        <locationY>695</locationY>
        <defaultConnector>
            <targetReference>Naming_required</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Update_Portal_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subtype__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record.FinancialProductType__r.PortalName__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinancialProductType__r.PortalName__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Portal_Display_Type</targetReference>
            </connector>
            <label>Update Portal Type</label>
        </rules>
    </decisions>
    <decisions>
        <name>Household_null</name>
        <label>Household null?</label>
        <locationX>458</locationX>
        <locationY>1295</locationY>
        <defaultConnector>
            <targetReference>Determine_ownership</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not null</defaultConnectorLabel>
        <rules>
            <name>Null</name>
            <conditionLogic>(1 OR 2) AND 3</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Household__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinServ__Household__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinServ__PrimaryOwner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Populate_household</targetReference>
            </connector>
            <label>Null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_this_a_pre_LOA_DB</name>
        <label>Is this a pre LOA DB w/o policy number?</label>
        <locationX>458</locationX>
        <locationY>2603</locationY>
        <defaultConnector>
            <targetReference>Status</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Pre_LOA_Defined_Benefit_Pension</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinServ__FinancialAccountNumber__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Do_we_have_their_NI_number</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Naming_required</name>
        <label>Naming required?</label>
        <locationX>458</locationX>
        <locationY>995</locationY>
        <defaultConnector>
            <targetReference>Set_name_of_FP</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>All others</defaultConnectorLabel>
        <rules>
            <name>Direct_holding</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Direct_Gilt_bond_holding</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Direct_equity_holding</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_direct_holding_name</targetReference>
            </connector>
            <label>Direct holding</label>
        </rules>
    </decisions>
    <decisions>
        <description>Routes differently depending on the product group so that different actions can be taken for different products. At the time of building, only actions for accounts were defined.</description>
        <name>Product_group</name>
        <label>Product group?</label>
        <locationX>458</locationX>
        <locationY>2195</locationY>
        <defaultConnector>
            <targetReference>Set_product_group_to_uncategorised</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Uncategorised</defaultConnectorLabel>
        <rules>
            <name>Account</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Annuity</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_AVC</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_BPR</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_BPR_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Cash_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Current_Account</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Defined_Benefit_Pension</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Direct_equity_holding</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Direct_Gilt_bond_holding</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_EIS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Endowment</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Fixed_Term_Deposit</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_General_Investment_Account_GIA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Group_Personal_Pension_GPP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Junior_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Junior_SIPP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Occupational_Company_Pension_Scheme</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Offset_Mortgage_Cash_Account</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Offshore_Bond</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Onshore_Bond</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Peer_Peer_Innovative_finance</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Peer_Peer_Innovative_finance_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Personal_Pension_PP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Pre_LOA_Defined_Benefit_Pension</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Pre_LOA_Investment</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Pre_LOA_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Pre_LOA_Defined_Contribution_Pension</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Premium_Bond</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Retirement_Annuity_Contract_RAC</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_SASS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SavingsAccount</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Scheme_Pension</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Section_32</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_SEIS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_SIPP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Stakeholder_Pension</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Stocks_Shares_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Structured_Product</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Structured_Product_ISA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_VCT</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_VCT_ISA</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_product_group_to_account</targetReference>
            </connector>
            <label>Account</label>
        </rules>
        <rules>
            <name>Trust</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Trust</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_product_group_to_trust</targetReference>
            </connector>
            <label>Trust</label>
        </rules>
        <rules>
            <name>Protection</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Accident_Sickness_Unemployment</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Income_Protection</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Life_Cover_CIC_Term</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Life_Cover_Term</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Whole_of_Life_Critical_Illness_Cover</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Life_Cover_Whole_of_Life</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Pre_LOA_Protection</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Family_Income_Benefit</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FP_Private_Medical</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_product_group_to_protection</targetReference>
            </connector>
            <label>Protection</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the financial product has a change to a particular status and makes updates in this case.</description>
        <name>Status</name>
        <label>Status changed to</label>
        <locationX>458</locationX>
        <locationY>3095</locationY>
        <defaultConnectorLabel>Other outcome</defaultConnectorLabel>
        <rules>
            <name>Closed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FinServ__Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Does_financial_product_have_a_value</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Closed</label>
        </rules>
        <rules>
            <name>Not_taken_up</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FinServ__Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Not Taken Up</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_value_to_null</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Not taken up</label>
        </rules>
    </decisions>
    <description>Runs before a financial product is saved to set the ownership to individual or joint depending on whether primary or joint owners are specified.</description>
    <environments>Default</environments>
    <formulas>
        <description>The name of the financial product based on whether there is just a primary owner or also a joint owner plus this is trimmed to 80 characters to prevent errors where names are too long.</description>
        <name>nameCapped</name>
        <dataType>String</dataType>
        <expression>LEFT( IF( ISBLANK( {!$Record.FinServ__JointOwner__c} ), 
{!$Record.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT( {!$Record.FinServ__PrimaryOwner__r.FirstName}, 1 ) + &quot; | &quot; + {!$Record.Public_Provider_Name__r.Name} + &quot; | &quot; + TEXT({!$Record.FinancialProductType__r.PortalName__c}),
{!$Record.FinServ__PrimaryOwner__r.LastName} + &quot;, &quot; + LEFT( {!$Record.FinServ__PrimaryOwner__r.FirstName}, 1 ) + &quot; &amp; &quot; + {!$Record.FinServ__JointOwner__r.LastName} + &quot;, &quot; + LEFT( {!$Record.FinServ__JointOwner__r.FirstName}, 1 ) + &quot; | &quot; + {!$Record.Public_Provider_Name__r.Name} + &quot; | &quot; + TEXT({!$Record.FinancialProductType__r.PortalName__c}) ), 80 )</expression>
    </formulas>
    <interviewLabel>Financial product - before save {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Financial product - before save</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Record_Type_ID_From_Developer_Name</name>
        <label>Get Record Type ID From Developer Name</label>
        <locationX>326</locationX>
        <locationY>395</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_New_Record_Type_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.FinancialProductType__r.FinancialProductRecordTypeDeveloperName__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>FinServ__FinancialAccount__c</stringValue>
            </value>
        </filters>
        <object>RecordType</object>
        <outputAssignments>
            <assignToReference>RecordTypeIDSpecifiedByFinancialProductType</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Set_policy_number_as_NI</name>
        <label>Set policy number as NI</label>
        <locationX>172</locationX>
        <locationY>2819</locationY>
        <connector>
            <targetReference>Status</targetReference>
        </connector>
        <inputAssignments>
            <field>FinServ__FinancialAccountNumber__c</field>
            <value>
                <elementReference>$Record.FinServ__PrimaryOwner__r.National_Insurance_Number__pc</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>332</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Does_FP_and_FPT_Record_Type_Developer_Name_Match</targetReference>
        </connector>
        <object>FinServ__FinancialAccount__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>RecordTypeIDSpecifiedByFinancialProductType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
