<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Add_product_to_unchanged_list</name>
        <label>Add product to unchanged list</label>
        <locationX>446</locationX>
        <locationY>3830</locationY>
        <assignmentItems>
            <assignToReference>unchangedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_4_Create_unchanged_products</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>areThereUnchangedProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_4_Create_unchanged_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_recommendation_to_collection</name>
        <label>Add recommendation and product ID to collections</label>
        <locationX>270</locationX>
        <locationY>1790</locationY>
        <assignmentItems>
            <assignToReference>recommendationsToCreate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToCreate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>rebalancedIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>rebalanceRecommendationsToDisplay</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToCreate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Clear_recToCreate</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_recommendation_to_collection_switch</name>
        <label>Add recommendation to collection</label>
        <locationX>358</locationX>
        <locationY>3422</locationY>
        <assignmentItems>
            <assignToReference>recommendationsToCreate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToCreate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>portfolioSwitchRecommendationsToDisplay</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recommendationToCreate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>switchedIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_3_Display_product_to_be_switched</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>446</locationX>
        <locationY>2306</locationY>
        <assignmentItems>
            <assignToReference>productsThatCouldHavePortfolioSwitches</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_2_Add_remaining_products_to_switch_list</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_2_Add_remaining_products_to_switch_list</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_toAdd_to_collection_rebalance_w_mandate_collection_rebalance_w_mandate</name>
        <label>Add to collection</label>
        <locationX>270</locationX>
        <locationY>866</locationY>
        <assignmentItems>
            <assignToReference>productsThatCouldBeRebalancedFiltered</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_0_Remove_products_without_a_mandate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_0_Remove_products_without_a_mandate</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_recommendation_variables</name>
        <label>Assign recommendation variables</label>
        <locationX>270</locationX>
        <locationY>1682</locationY>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Advice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Household__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.DestinationLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.InvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.OW_Investment_Mandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.RecommendationType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_rebalance_recommendation_type_id.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.DestinationName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.PreRequisiteActionRecommendation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>preReqSelectReb.firstSelectedRow.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.PrimaryOwner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.FinServ__PrimaryOwner__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.JointOwner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.FinServ__JointOwner__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.RegisteredContact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_products_to_rebalance.Registered_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_recommendation_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_recommendation_variables_switch</name>
        <label>Assign recommendation variables</label>
        <locationX>358</locationX>
        <locationY>3314</locationY>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Advice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Household__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.DestinationLegacy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.RecommendationType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_portfolio_switch_record_type.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.NewInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>newPortfolioSelect</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.PreviousInvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.OW_Investment_Mandate__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.InvestmentMandate__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.DestinationName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.PreRequisiteActionRecommendation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>preReqselect.firstSelectedRow.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.PrimaryOwner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.FinServ__PrimaryOwner__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.JointOwner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.FinServ__JointOwner__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recommendationToCreate.RegisteredContact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Display_product_to_be_switched.Registered_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_recommendation_to_collection_switch</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_recToCreate</name>
        <label>Clear recToCreate</label>
        <locationX>270</locationX>
        <locationY>1898</locationY>
        <assignmentItems>
            <assignToReference>recommendationToCreate</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Loop_through_products_to_rebalance</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Does_it_have_a_mandate</name>
        <label>Does it have a mandate?</label>
        <locationX>402</locationX>
        <locationY>758</locationY>
        <defaultConnector>
            <targetReference>Loop_0_Remove_products_without_a_mandate</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesMandate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_0_Remove_products_without_a_mandate.OW_Investment_Mandate__c</leftValueReference>
                <operator>NotEqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Add_toAdd_to_collection_rebalance_w_mandate_collection_rebalance_w_mandate</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_this_been_marked_for_change</name>
        <label>Has this been marked for change?</label>
        <locationX>358</locationX>
        <locationY>3722</locationY>
        <defaultConnector>
            <targetReference>Add_product_to_unchanged_list</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesChanged</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>rebalancedIds</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_4_Create_unchanged_products.Id</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>switchedIds</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_4_Create_unchanged_products.Id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_4_Create_unchanged_products</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Have_rebalances_been_set_up_before</name>
        <label>Have rebalances been set up before?</label>
        <locationX>182</locationX>
        <locationY>242</locationY>
        <defaultConnector>
            <targetReference>Get_products_for_rebalance</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.RebalancesSetUp__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Duplicate_warning</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_the_product_going_to_be_rebalanced</name>
        <label>Is the product going to be rebalanced?</label>
        <locationX>358</locationX>
        <locationY>2198</locationY>
        <defaultConnector>
            <targetReference>Add_to_collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesRebalanced</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>rebalancedIds</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_2_Add_remaining_products_to_switch_list.Id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_2_Add_remaining_products_to_switch_list</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>New_portfolio_selected</name>
        <label>New portfolio selected?</label>
        <locationX>358</locationX>
        <locationY>3014</locationY>
        <defaultConnector>
            <targetReference>Needs_different_portfolio</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesNewPortfolio</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>newPortfolioSelect</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>Loop_3_Display_product_to_be_switched.OW_Investment_Mandate__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_recommendation_variables_switch</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>Screen flow to allow for creation of rebalance and portfolio switch fulfilments</description>
    <dynamicChoiceSets>
        <name>InvestmentMandateChoices</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true" />
        <object xsi:nil="true" />
        <picklistField>OW_Investment_Mandate__c</picklistField>
        <picklistObject>FinServ__FinancialAccount__c</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <interviewLabel>Recommendation - set up rebalances and switches {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Recommendation | set up rebalances and switches</label>
    <loops>
        <name>Loop_0_Remove_products_without_a_mandate</name>
        <label>Loop 0 | Remove products without a mandate</label>
        <locationX>182</locationX>
        <locationY>650</locationY>
        <collectionReference>productsThatCouldBeRebalanced</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Does_it_have_a_mandate</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_investment_mandate_record_type_id</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_2_Add_remaining_products_to_switch_list</name>
        <label>Loop 2 | Add remaining products to switch list</label>
        <locationX>182</locationX>
        <locationY>2090</locationY>
        <collectionReference>productsThatCouldBeRebalanced</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_the_product_going_to_be_rebalanced</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Select_products_for_portfolio_switch</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_3_Display_product_to_be_switched</name>
        <label>Loop 3 | Display product to be switched</label>
        <locationX>182</locationX>
        <locationY>2798</locationY>
        <collectionReference>productsToBeswitchedSelection.selectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Select_new_portfolio_screen</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Loop_4_Create_unchanged_products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_4_Create_unchanged_products</name>
        <label>Loop 4 | Create unchanged products</label>
        <locationX>182</locationX>
        <locationY>3614</locationY>
        <collectionReference>productsThatCouldBeRebalanced</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Has_this_been_marked_for_change</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Check_screen</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_through_products_to_rebalance</name>
        <label>Loop 1 | Products to rebalance</label>
        <locationX>182</locationX>
        <locationY>1466</locationY>
        <collectionReference>productsToBeRebalancedSelection.selectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_rebalances</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Loop_2_Add_remaining_products_to_switch_list</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_recommendations</name>
        <label>Create recommendations</label>
        <locationX>182</locationX>
        <locationY>4214</locationY>
        <connector>
            <targetReference>Update_advice</targetReference>
        </connector>
        <inputReference>recommendationsToCreate</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_investment_mandate_record_type_id</name>
        <label>Get investment mandate record type id</label>
        <locationX>182</locationX>
        <locationY>1142</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_rebalance_recommendation_type_id</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Label</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>RT - Recommendation - Rebalance</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OW_record_type_reference__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_portfolio_switch_record_type</name>
        <label>Get portfolio switch record type</label>
        <locationX>182</locationX>
        <locationY>2690</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_3_Display_product_to_be_switched</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ReferenceName__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>PORTFOLIO_SWITCH</stringValue>
            </value>
        </filters>
        <filters>
            <field>Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecommendationType__c</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_potential_pre_reqs</name>
        <label>Get potential pre-reqs</label>
        <locationX>182</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Have_rebalances_been_set_up_before</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Household__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>RecommendationTypeName__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Open product</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Declined</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Recommendation__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_products_for_rebalance</name>
        <label>Get potential products for rebalance</label>
        <locationX>182</locationX>
        <locationY>542</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_0_Remove_products_without_a_mandate</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Household__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>FinServ__Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Open</stringValue>
            </value>
        </filters>
        <filters>
            <field>OW_own_product__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Benefit_amount__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>FinServ__FinancialAccount__c</object>
        <outputReference>productsThatCouldBeRebalanced</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>OW_Investment_Mandate__c</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>FP_Value__c</queriedFields>
        <queriedFields>FinServ__FinancialAccountNumber__c</queriedFields>
        <queriedFields>FinServ__PrimaryOwner__c</queriedFields>
        <queriedFields>FinServ__JointOwner__c</queriedFields>
        <queriedFields>Registered_Contact__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_rebalance_recommendation_type_id</name>
        <label>Get rebalance recommendation type id</label>
        <locationX>182</locationX>
        <locationY>1250</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Select_products_for_rebalancing</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ReferenceName__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>REBALANCE</stringValue>
            </value>
        </filters>
        <filters>
            <field>Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecommendationType__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_advice</name>
        <label>Update advice</label>
        <locationX>182</locationX>
        <locationY>4322</locationY>
        <connector>
            <targetReference>DoneDoneScreen</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>RebalancesSetUp__c</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <object>Advice__c</object>
    </recordUpdates>
    <screens>
        <name>Check_rebalances</name>
        <label>Check rebalances</label>
        <locationX>270</locationX>
        <locationY>1574</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_recommendation_variables</targetReference>
        </connector>
        <fields>
            <name>rebalanceDisplay</name>
            <fieldText>&lt;p&gt;Rebalance for &lt;strong&gt;{!Loop_through_products_to_rebalance.Name}&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>preReqToggleReb</name>
            <extensionName>flowruntime:toggle</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Is there an action that has to happen before this rebalance can occur?</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>messageToggleActive</name>
                <value>
                    <stringValue>Yes</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>messageToggleInactive</name>
                <value>
                    <stringValue>No</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>preReqSelectReb</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Data Table</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>SINGLE_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Get_potential_pre_reqs</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>1.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationSummary__c&quot;,&quot;guid&quot;:&quot;column-e898&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation Summary&quot;,&quot;type&quot;:&quot;customRichText&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>preReqToggleReb.value</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Check_screen</name>
        <label>Check screen</label>
        <locationX>182</locationX>
        <locationY>4106</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Create_recommendations</targetReference>
        </connector>
        <fields>
            <name>checkExplanationText</name>
            <fieldText>&lt;p&gt;Below is a summary of the recommendations we&#39;ll create. If everything looks correct click next. Otherwise, use the previous button to go back to what you need to change.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>toBeRebalancedDisplayCheck</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Rebalances</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>rebalanceRecommendationsToDisplay</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;DestinationName__c&quot;,&quot;guid&quot;:&quot;column-25d0&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Destination Name&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;InvestmentMandate__c&quot;,&quot;guid&quot;:&quot;column-809b&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Mandate&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Investment Mandate&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>shouldDisplayLabel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>rebalancedIds</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>blank1</name>
            <fieldText>&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>toBeSwitchedDisplayCheck</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Portfolio Switches</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>shouldDisplayLabel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>portfolioSwitchRecommendationsToDisplay</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;DestinationName__c&quot;,&quot;guid&quot;:&quot;column-16c1&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Destination Name&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;PreviousInvestmentMandate__c&quot;,&quot;guid&quot;:&quot;column-c5d0&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Previous investment mandate&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;NewInvestmentMandate__c&quot;,&quot;guid&quot;:&quot;column-c3b0&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;New investment mandate&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>switchedIds</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>blank2</name>
            <fieldText>&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>noChangesDisplayCheck</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>FinServ__FinancialAccount__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>No changes</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>unchangedProducts</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-fef6&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Financial Product&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;OW_Investment_Mandate__c&quot;,&quot;guid&quot;:&quot;column-e6fd&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Mandate&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;OW Investment Mandate&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>shouldDisplayLabel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>areThereUnchangedProducts</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>DoneDoneScreen</name>
        <label>Done</label>
        <locationX>182</locationX>
        <locationY>4430</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>DoneText</name>
            <fieldText>&lt;p&gt;This recommendation will be created once you&#39;ve finished this flow. &lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: var(--slds-g-color-neutral-base-100, var(--lwc-colorBackgroundInput,rgb(255, 255, 255))); color: var(--slds-g-color-neutral-base-30, var(--lwc-colorTextWeak,rgb(68, 68, 68))); font-size: var(--lwc-fontSize3,0.8125rem); font-family: var(--lwc-fontFamily,-apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Helvetica, Arial, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;);&quot;&gt;When you click Finish, you&#39;ll be taken to the screen that allow you to select the next recommendation type you&#39;d like to create.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Duplicate_warning</name>
        <label>Duplicate warning</label>
        <locationX>50</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_products_for_rebalance</targetReference>
        </connector>
        <fields>
            <name>Warningdisplay</name>
            <fieldText>&lt;p&gt;Our records show that someone has already set up rebalances and portfolio switches for this advice. Please go check the existing recommendations before proceeding, to prevent any duplicates being created.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;If you&#39;re happy this needs to be done again, please continue.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Needs_different_portfolio</name>
        <label>Needs different portfolio</label>
        <locationX>446</locationX>
        <locationY>3122</locationY>
        <allowBack>true</allowBack>
        <allowFinish>false</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_recommendation_variables_switch</targetReference>
        </connector>
        <fields>
            <name>ChooseDifferentText</name>
            <fieldText>&lt;p&gt;You&#39;ve chosen the same portfolio that is already in use. Please choose a different portfolio, or select this product for a rebalance instead.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Select_new_portfolio_screen</name>
        <label>Select new portfolio</label>
        <locationX>358</locationX>
        <locationY>2906</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>New_portfolio_selected</targetReference>
        </connector>
        <fields>
            <name>Switchtext</name>
            <fieldText>&lt;p&gt;Please choose the new portfolio for the below product:&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>productDetailDisplay</name>
            <fieldText>&lt;p&gt;&lt;strong&gt;Name: &lt;/strong&gt;{!Loop_3_Display_product_to_be_switched.Name}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Account number: &lt;/strong&gt;{!Loop_3_Display_product_to_be_switched.FinServ__FinancialAccountNumber__c}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Current portfolio: &lt;/strong&gt;{!Loop_3_Display_product_to_be_switched.OW_Investment_Mandate__c}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>newPortfolioSelect</name>
            <choiceReferences>InvestmentMandateChoices</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select new portfolio</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>preReqToggle</name>
            <extensionName>flowruntime:toggle</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Is there an action that has to happen before this switch can happen?</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>messageToggleActive</name>
                <value>
                    <stringValue>Yes</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>messageToggleInactive</name>
                <value>
                    <stringValue>No</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>preReqselect</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Data Table</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>SINGLE_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Get_potential_pre_reqs</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>1.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationSummary__c&quot;,&quot;guid&quot;:&quot;column-46a1&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation Summary&quot;,&quot;type&quot;:&quot;customRichText&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>preReqToggle.value</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Select_products_for_portfolio_switch</name>
        <label>Select products for portfolio switch</label>
        <locationX>182</locationX>
        <locationY>2582</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_portfolio_switch_record_type</targetReference>
        </connector>
        <fields>
            <name>switchExplanation</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;font-size: 20px;&quot;&gt;Portfolio switches&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Please select which products you would like to undergo a portfolio switch.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>productsToBeswitchedSelection</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>FinServ__FinancialAccount__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Available products</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>shouldDisplayLabel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>productsThatCouldHavePortfolioSwitches</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-9a7a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Financial Product&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;FP_Value__c&quot;,&quot;guid&quot;:&quot;column-3fc7&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Value&quot;,&quot;type&quot;:&quot;currency&quot;},{&quot;apiName&quot;:&quot;FinServ__FinancialAccountNumber__c&quot;,&quot;guid&quot;:&quot;column-86cd&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Account Number&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;OW_Investment_Mandate__c&quot;,&quot;guid&quot;:&quot;column-a87a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;OW Investment Mandate&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Select_products_for_rebalancing</name>
        <label>Select products for rebalancing</label>
        <locationX>182</locationX>
        <locationY>1358</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Loop_through_products_to_rebalance</targetReference>
        </connector>
        <fields>
            <name>rebalanceExplaination</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;font-size: 20px;&quot;&gt;Rebalances&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Please select all products in the table below which you would like to be &lt;span style=&quot;color: rgb(221, 5, 24);&quot;&gt;rebalanced&lt;/span&gt;.&lt;/p&gt;&lt;p&gt;You&#39;ll be able to select products for portfolio switches on the next screen.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>productsToBeRebalancedSelection</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>FinServ__FinancialAccount__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Available products</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>shouldDisplayLabel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>productsThatCouldBeRebalancedFiltered</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-9a7a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Financial Product&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;FP_Value__c&quot;,&quot;guid&quot;:&quot;column-3fc7&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Value&quot;,&quot;type&quot;:&quot;currency&quot;},{&quot;apiName&quot;:&quot;FinServ__FinancialAccountNumber__c&quot;,&quot;guid&quot;:&quot;column-86cd&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Account Number&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;OW_Investment_Mandate__c&quot;,&quot;guid&quot;:&quot;column-a87a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;OW Investment Mandate&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>56</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_potential_pre_reqs</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>advice</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Advice__c</objectType>
    </variables>
    <variables>
        <name>areThereUnchangedProducts</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>portfolioSwitchRecommendationsToDisplay</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>productsThatCouldBeRebalanced</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>FinServ__FinancialAccount__c</objectType>
    </variables>
    <variables>
        <name>productsThatCouldBeRebalancedFiltered</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>FinServ__FinancialAccount__c</objectType>
    </variables>
    <variables>
        <name>productsThatCouldHavePortfolioSwitches</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>FinServ__FinancialAccount__c</objectType>
    </variables>
    <variables>
        <name>rebalancedIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>rebalanceRecommendationsToDisplay</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>recommendationsToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>recommendationToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>switchedIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>unchangedProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>FinServ__FinancialAccount__c</objectType>
    </variables>
</Flow>
