<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <actionCalls>
        <name>Generate_random_number</name>
        <label>Generate random number</label>
        <locationX>930</locationX>
        <locationY>650</locationY>
        <actionName>NumberGenerateRandomNumber</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Are_there_any_recommendations_outstanding</targetReference>
        </connector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>odds</name>
            <value>
                <numberValue>10.0</numberValue>
            </value>
        </inputParameters>
        <nameSegment>NumberGenerateRandomNumber</nameSegment>
        <offset>0</offset>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Add_1_to_count</name>
        <label>Add 1 to count</label>
        <locationX>842</locationX>
        <locationY>8894</locationY>
        <assignmentItems>
            <assignToReference>count</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>unchangedRecs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Count_unchanged_recommendations</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Count_unchanged_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_recommendation_type_to_collection</name>
        <label>Add recommendation type to collection</label>
        <locationX>842</locationX>
        <locationY>3530</locationY>
        <assignmentItems>
            <assignToReference>recommendationTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Compile_recommendation_types.RecommendationTypeName__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Compile_recommendation_types</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_changeable_recs</name>
        <label>Add to changeable recs</label>
        <locationX>842</locationX>
        <locationY>5462</locationY>
        <assignmentItems>
            <assignToReference>changeableRecs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_3_1_Filter_changeable_recs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_3_1_Filter_changeable_recs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>512</locationX>
        <locationY>2414</locationY>
        <assignmentItems>
            <assignToReference>recsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedRecs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Accepted_new_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection5</name>
        <label>Add to collection</label>
        <locationX>930</locationX>
        <locationY>7178</locationY>
        <assignmentItems>
            <assignToReference>declineableRecommendations</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_5_Recommendations_left_to_decline</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Has_this_recommendation_type_been_added_yet</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection6</name>
        <label>Add to collection</label>
        <locationX>1018</locationX>
        <locationY>7394</locationY>
        <assignmentItems>
            <assignToReference>recommendationTypes</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_5_Recommendations_left_to_decline.RecommendationTypeName__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_5_Recommendations_left_to_decline</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection7</name>
        <label>Add to collection</label>
        <locationX>842</locationX>
        <locationY>8186</locationY>
        <assignmentItems>
            <assignToReference>recToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_7_Recommendations_of_this_type_to_decline.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Declined</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DateOfDecision__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>declinedDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_7_Recommendations_of_this_type_to_decline.Amount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.RecommendationTypeName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_6_Recommendation_types_to_decline</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DestinationName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_7_Recommendations_of_this_type_to_decline.DestinationName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.PhasingFrequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_7_Recommendations_of_this_type_to_decline.PhasingFrequency__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.PhasingPeriod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_7_Recommendations_of_this_type_to_decline.PhasingPeriod__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.NonStandardActionInstruction__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_7_Recommendations_of_this_type_to_decline.NonStandardActionInstruction__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collection8</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection8</name>
        <label>Add to collection</label>
        <locationX>842</locationX>
        <locationY>8294</locationY>
        <assignmentItems>
            <assignToReference>recsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedRecs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_7_Recommendations_of_this_type_to_decline</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collectionAcceptableRecommendations</name>
        <label>Add to collection</label>
        <locationX>666</locationX>
        <locationY>1490</locationY>
        <assignmentItems>
            <assignToReference>recommendations</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Get_acceptable_recommendations</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_acceptable_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collectionChangedRecs</name>
        <label>Add to collection</label>
        <locationX>416</locationX>
        <locationY>6602</locationY>
        <assignmentItems>
            <assignToReference>recsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedRecs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Changed_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collectionOthers</name>
        <label>Add to collection</label>
        <locationX>886</locationX>
        <locationY>4454</locationY>
        <assignmentItems>
            <assignToReference>recsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedRecs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recToUpdate.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_4_Recommendations_to_accept</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_earliest_decision_date</name>
        <label>Assign earliest decision date</label>
        <locationX>930</locationX>
        <locationY>434</locationY>
        <assignmentItems>
            <assignToReference>earliestDecisionDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.DateAccepted__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_all_open_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_update_variables</name>
        <label>Assign update variables</label>
        <locationX>512</locationX>
        <locationY>2306</locationY>
        <assignmentItems>
            <assignToReference>recToUpdate.DateOfDecision__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>DateNewProdsAccepted</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Accepted</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Accepted_new_products.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.RecommendationTypeName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Open product</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DestinationName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Accepted_new_products.DestinationName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.FulfilmentDeadline__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>latestFulfilmentDateNewProds</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_update_variables_others</name>
        <label>Assign update variables</label>
        <locationX>886</locationX>
        <locationY>4346</locationY>
        <assignmentItems>
            <assignToReference>recToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_4_Recommendations_to_accept.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Accepted</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DateOfDecision__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>othersAccepted</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.RecommendationTypeName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_3_Recommendation_types</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DestinationName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_4_Recommendations_to_accept.DestinationName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_4_Recommendations_to_accept.Amount__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.FulfilmentDeadline__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>latestFulfilmentDeadlineAccepted</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.NonStandardActionInstruction__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_4_Recommendations_to_accept.NonStandardActionInstruction__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collectionOthers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_update_variablesChangedRecs</name>
        <label>Assign update variables</label>
        <locationX>416</locationX>
        <locationY>6494</locationY>
        <assignmentItems>
            <assignToReference>recToUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Changed_recommendations.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Accepted</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DateOfDecision__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>othersAccepted</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.RecommendationTypeName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Changed_recommendations.RecommendationTypeName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.DestinationName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Changed_recommendations.DestinationName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>newAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.FulfilmentDeadline__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LatestFulfilmentDateChangedRecs</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.PhasingFrequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>new_Phasing_frequency</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recToUpdate.PhasingPeriod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>new_Phasing_period</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collectionChangedRecs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Changeable_products_count</name>
        <label>Changeable products count</label>
        <locationX>578</locationX>
        <locationY>5738</locationY>
        <assignmentItems>
            <assignToReference>count</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>changeableRecs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Are_there_any_changeable_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_recommendation_types_variable</name>
        <label>Clear recommendation types variable</label>
        <locationX>578</locationX>
        <locationY>5030</locationY>
        <assignmentItems>
            <assignToReference>recommendationTypes</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Changeable_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_variables</name>
        <label>Clear variables</label>
        <locationX>424</locationX>
        <locationY>3014</locationY>
        <assignmentItems>
            <assignToReference>recToUpdate</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recsToUpdate</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Other_acceptable_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_0</name>
        <label>Count = 0</label>
        <locationX>578</locationX>
        <locationY>8570</locationY>
        <assignmentItems>
            <assignToReference>count</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>countNotOpen</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>recsToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Count_unchanged_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>New_products_count</name>
        <label>New products count</label>
        <locationX>578</locationX>
        <locationY>1874</locationY>
        <assignmentItems>
            <assignToReference>count</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Open_product_recs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Are_there_any_open_product_recommendations_to_accept</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Selected_for_change_count</name>
        <label>Selected for change count</label>
        <locationX>436</locationX>
        <locationY>6062</locationY>
        <assignmentItems>
            <assignToReference>count</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>changeRecs.selectedRows</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Were_any_recommendations_selected_for_change</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Setting this so we can ensure the task to chase recommendation acceptance stays open at the end.</description>
        <name>Set_someAccepted_variable</name>
        <label>Set someAccepted variable</label>
        <locationX>842</locationX>
        <locationY>1082</locationY>
        <assignmentItems>
            <assignToReference>someAccepted</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_acceptable_recommendations</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_earliest_date</name>
        <label>Update earliest date</label>
        <locationX>292</locationX>
        <locationY>2822</locationY>
        <assignmentItems>
            <assignToReference>earliestDecisionDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>DateNewProdsAccepted</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Clear_variables</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_earliest_dateOtherTypes</name>
        <label>Update earliest date</label>
        <locationX>666</locationX>
        <locationY>4754</locationY>
        <assignmentItems>
            <assignToReference>earliestDecisionDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>othersAccepted</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_3_Recommendation_types</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Monthly</name>
        <choiceText>Monthly</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Monthly</stringValue>
        </value>
    </choices>
    <choices>
        <name>Single</name>
        <choiceText>Single</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Single</stringValue>
        </value>
    </choices>
    <collectionProcessors>
        <name>Acceptable_recommendations_for_this_type</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Acceptable recommendations for this type</label>
        <locationX>798</locationX>
        <locationY>4022</locationY>
        <assignNextValueToReference>currentItem_Acceptable_recommendations_for_this_type</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Other_acceptable_recommendations</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Acceptable_recommendations_for_this_type.RecommendationTypeName__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>Loop_3_Recommendation_types</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Acceptance_screen</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Changeable_recommendations</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Changeable recommendations</label>
        <locationX>578</locationX>
        <locationY>5138</locationY>
        <assignNextValueToReference>currentItem_Other_acceptable_recommendations</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>recommendations</collectionReference>
        <conditionLogic>formula_evaluates_to_true</conditionLogic>
        <connector>
            <targetReference>Loop_3_1_Filter_changeable_recs</targetReference>
        </connector>
        <formula>(
(( ISBLANK({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendation__c}) || ISPICKVAL({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendation__r.Status__c}, &quot;Accepted&quot;) )
&amp;&amp;
 ( ISBLANK({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendationSource__c}) || ISPICKVAL({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendationSource__r.Status__c}, &quot;Accepted&quot;) )) 
&amp;&amp;
( {!currentItem_Other_acceptable_recommendations.RecommendationType__r.ReferenceName__c} = &quot;LUMP_SUM&quot;
||
{!currentItem_Other_acceptable_recommendations.RecommendationType__r.ReferenceName__c} = &quot;INTERNAL_TRANSFER&quot; || {!currentItem_Other_acceptable_recommendations.RecommendationType__r.ReferenceName__c} = &quot;LUMP_SUM_WITHDRAWAL&quot;
)
)
&amp;&amp;
ISPICKVAL({!currentItem_Other_acceptable_recommendations.Status__c}, &quot;Awaiting decision&quot;)</formula>
    </collectionProcessors>
    <collectionProcessors>
        <name>Declineable_recommendations_of_this_type</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Declineable recommendations of this type</label>
        <locationX>754</locationX>
        <locationY>7862</locationY>
        <assignNextValueToReference>currentItem_Declineable_recommendations_of_this_type</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>declineableRecommendations</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Declineable_recommendations_of_this_type.RecommendationTypeName__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>Loop_6_Recommendation_types_to_decline</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Declined_screen</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Open_product_recs</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Open product recs</label>
        <locationX>578</locationX>
        <locationY>1766</locationY>
        <assignNextValueToReference>currentItem_Open_product_recs</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>recommendations</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Open_product_recs.Status__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Awaiting decision</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Open_product_recs.RecommendationTypeName__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Open product</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>New_products_count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Other_acceptable_recommendations</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Other acceptable recommendations</label>
        <locationX>578</locationX>
        <locationY>3206</locationY>
        <assignNextValueToReference>currentItem_Other_acceptable_recommendations</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>recommendations</collectionReference>
        <conditionLogic>formula_evaluates_to_true</conditionLogic>
        <connector>
            <targetReference>Compile_recommendation_types</targetReference>
        </connector>
        <formula>(
  (
    ( ISBLANK({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendation__c}) || ISPICKVAL({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendation__r.Status__c}, &quot;Accepted&quot;) 
    )
&amp;&amp;
 ( 
ISBLANK({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendationSource__c}) || ISPICKVAL({!currentItem_Other_acceptable_recommendations.PreRequisiteRecommendationSource__r.Status__c}, &quot;Accepted&quot;) 
)

)
|| 
{!currentItem_Acceptable_recommendations_for_this_type.RecommendationTypeName__c} = &quot;Cancel existing regular&quot;
)</formula>
    </collectionProcessors>
    <collectionProcessors>
        <name>Sort_types</name>
        <elementSubtype>SortCollectionProcessor</elementSubtype>
        <label>Sort types</label>
        <locationX>578</locationX>
        <locationY>3806</locationY>
        <collectionProcessorType>SortCollectionProcessor</collectionProcessorType>
        <collectionReference>recommendationTypes</collectionReference>
        <connector>
            <targetReference>Loop_3_Recommendation_types</targetReference>
        </connector>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortOrder>Desc</sortOrder>
        </sortOptions>
    </collectionProcessors>
    <decisions>
        <name>Are_there_any_changeable_recommendations</name>
        <label>Are there any changeable recommendations?</label>
        <locationX>578</locationX>
        <locationY>5846</locationY>
        <defaultConnector>
            <targetReference>Loop_5_Recommendations_left_to_decline</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesChangeable</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>count</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mark_changed_recs</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_there_any_open_product_recommendations_to_accept</name>
        <label>Are there any open product recommendations to accept?</label>
        <locationX>578</locationX>
        <locationY>1982</locationY>
        <defaultConnector>
            <targetReference>Other_acceptable_recommendations</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>count</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Accept_open_products</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_there_any_recommendations_outstanding</name>
        <label>Are there any recommendations outstanding?</label>
        <locationX>930</locationX>
        <locationY>758</locationY>
        <defaultConnector>
            <targetReference>Nothing_to_do</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesOutstandingRecs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_all_open_recommendations</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>What_level_of_acceptance_have_we_reached</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_there_are_any_recommendations_outstanding</name>
        <label>Are there are any recommendations outstanding?</label>
        <locationX>578</locationX>
        <locationY>9686</locationY>
        <defaultConnector>
            <targetReference>Update_tasks</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesRecsAwaiting</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>count</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>someAccepted</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_the_advice_need_updating</name>
        <label>Does the advice need updating?</label>
        <locationX>578</locationX>
        <locationY>9386</locationY>
        <defaultConnector>
            <targetReference>Are_there_are_any_recommendations_outstanding</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesUPdateAdviceAcceptedDate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>earliestDecisionDate</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>advice.DateAccepted__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_advice</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_the_earliest_date_accepted_need_updating</name>
        <label>Does the earliest date accepted need updating?</label>
        <locationX>424</locationX>
        <locationY>2714</locationY>
        <defaultConnector>
            <targetReference>Clear_variables</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesUpdateDate</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>earliestDecisionDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>earliestDecisionDate</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <elementReference>DateNewProdsAccepted</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_earliest_date</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_the_earliest_date_accepted_need_updating_after_this_type</name>
        <label>Does the earliest date accepted need updating after this type?</label>
        <locationX>798</locationX>
        <locationY>4646</locationY>
        <defaultConnector>
            <targetReference>Loop_3_Recommendation_types</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesUpdateDateAfterOtherRecs</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>earliestDecisionDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>earliestDecisionDate</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <elementReference>othersAccepted</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_earliest_dateOtherTypes</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>HAs_advice_been_passed_in</name>
        <label>Has advice been passed in?</label>
        <locationX>930</locationX>
        <locationY>134</locationY>
        <defaultConnector>
            <targetReference>Get_advice</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesAdviceReceived</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_earliest_decision_date</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_this_been_accepted_already</name>
        <label>Has this been accepted already?</label>
        <locationX>754</locationX>
        <locationY>5354</locationY>
        <defaultConnector>
            <targetReference>Add_to_changeable_recs</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesAcceptedAlready</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>updatedRecs</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_3_1_Filter_changeable_recs.Id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_3_1_Filter_changeable_recs</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_this_been_accepted_by_the_clients</name>
        <label>Has this been accepted by the clients?</label>
        <locationX>798</locationX>
        <locationY>1382</locationY>
        <defaultConnector>
            <targetReference>Get_acceptable_recommendations</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesAccepted</name>
            <conditionLogic>( (1 OR 4 OR 6) AND (2 OR 3) ) OR 5</conditionLogic>
            <conditions>
                <leftValueReference>acceptedClients</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Get_acceptable_recommendations.PrimaryOwner__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>acceptedClients</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Get_acceptable_recommendations.JointOwner__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_acceptable_recommendations.JointOwner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>acceptedClients</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Get_acceptable_recommendations.RegisteredContact__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_acceptable_recommendations.RecommendationType__r.ReferenceName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PROTECTION_REVIEW</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_acceptable_recommendations.PrimaryOwner__r.FinServ__Age__pc</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>18.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_to_collectionAcceptableRecommendations</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_this_been_recorded_yet</name>
        <label>Has this been recorded yet?</label>
        <locationX>798</locationX>
        <locationY>7070</locationY>
        <defaultConnector>
            <targetReference>Add_to_collection5</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesRecordedBefore</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>updatedRecs</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_5_Recommendations_left_to_decline.Id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_5_Recommendations_left_to_decline</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_this_one_been_recorded_yet</name>
        <label>Has this one been recorded yet?</label>
        <locationX>754</locationX>
        <locationY>3422</locationY>
        <defaultConnector>
            <targetReference>Add_recommendation_type_to_collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesRecorded</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>recommendationTypes</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Compile_recommendation_types.RecommendationTypeName__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Compile_recommendation_types.RecommendationType__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Open product</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Compile_recommendation_types</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_this_recommendation_type_been_added_yet</name>
        <label>Has this recommendation type been added yet?</label>
        <locationX>930</locationX>
        <locationY>7286</locationY>
        <defaultConnector>
            <targetReference>Add_to_collection6</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesAdded</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recommendationTypes</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_5_Recommendations_left_to_decline.RecommendationTypeName__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_5_Recommendations_left_to_decline</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_this_one_updated</name>
        <label>Is this one updated?</label>
        <locationX>754</locationX>
        <locationY>8786</locationY>
        <defaultConnector>
            <targetReference>Add_1_to_count</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesUpdated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>updatedRecs</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Count_unchanged_recommendations.Id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Count_unchanged_recommendations</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Were_any_recommendations_selected_for_change</name>
        <label>Were any recommendations selected for change?</label>
        <locationX>436</locationX>
        <locationY>6170</locationY>
        <defaultConnector>
            <targetReference>Loop_5_Recommendations_left_to_decline</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>YesChangedRecs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>count</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Changed_recommendations</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Uses the outputs of the advice recipients flow, which were passed into this one, to determine what warning should be given to partners</description>
        <name>What_level_of_acceptance_have_we_reached</name>
        <label>What level of acceptance have we reached?</label>
        <locationX>578</locationX>
        <locationY>866</locationY>
        <defaultConnector>
            <targetReference>Get_acceptable_recommendations</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>All_clients_declined</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>numDeclinedClients</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>numAdvisedClients</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Call_decline_advice_flow</targetReference>
            </connector>
            <label>All clients declined</label>
        </rules>
        <rules>
            <name>All_clients_undecided</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>numDecidedClients</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Undecided_toast</targetReference>
            </connector>
            <label>All clients undecided</label>
        </rules>
        <rules>
            <name>All_clients_accepted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>numAcceptedClients</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>numAdvisedClients</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Full_acceptance_toast</targetReference>
            </connector>
            <label>All clients accepted</label>
        </rules>
        <rules>
            <name>Some_clients_accepted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>numAcceptedClients</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>numAdvisedClients</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Partial_acceptance_toast</targetReference>
            </connector>
            <label>Some clients accepted</label>
        </rules>
    </decisions>
    <description>Flow to allow partners to mark recommendations as accepted</description>
    <dynamicChoiceSets>
        <name>phasingFreqChoice</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true" />
        <object xsi:nil="true" />
        <picklistField>PhasingFrequency__c</picklistField>
        <picklistObject>Recommendation__c</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <name>LatestFulfilmentDateChangedRecs</name>
        <dataType>Date</dataType>
        <expression>IF( ISBLANK({!Changed_recommendations.FulfilmentDeadline__c}), DATE(YEAR({!othersAccepted})+1, MONTH({!othersAccepted}), DAY({!othersAccepted})), {!Changed_recommendations.FulfilmentDeadline__c})</expression>
    </formulas>
    <formulas>
        <name>latestFulfilmentDateNewProds</name>
        <dataType>Date</dataType>
        <expression>IF( ISBLANK({!Accepted_new_products.FulfilmentDeadline__c}), DATE(YEAR({!DateNewProdsAccepted})+1, MONTH({!DateNewProdsAccepted}), DAY({!DateNewProdsAccepted})), {!Accepted_new_products.FulfilmentDeadline__c})</expression>
    </formulas>
    <formulas>
        <name>latestFulfilmentDeadlineAccepted</name>
        <dataType>Date</dataType>
        <expression>IF( ISBLANK({!Loop_4_Recommendations_to_accept.FulfilmentDeadline__c}), DATE(YEAR({!othersAccepted})+1, MONTH({!othersAccepted}), DAY({!othersAccepted})), {!Loop_4_Recommendations_to_accept.FulfilmentDeadline__c})</expression>
    </formulas>
    <formulas>
        <name>numDecidedClients</name>
        <dataType>Number</dataType>
        <expression>{!numAcceptedClients} + {!numDeclinedClients}</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Recommendation - record decisions {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Recommendation | record decisions</label>
    <loops>
        <name>Accepted_new_products</name>
        <label>Loop 1 | Accepted new products</label>
        <locationX>424</locationX>
        <locationY>2198</locationY>
        <collectionReference>newprodAcceptSelect.selectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_update_variables</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_new_product_recommendations</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Changed_recommendations</name>
        <label>Changed recommendations</label>
        <locationX>328</locationX>
        <locationY>6278</locationY>
        <collectionReference>changeRecs.selectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Collect_change_details</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Loop_5_Recommendations_left_to_decline</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Compile_recommendation_types</name>
        <label>Loop 2 | Compile recommendation types</label>
        <locationX>578</locationX>
        <locationY>3314</locationY>
        <collectionReference>Other_acceptable_recommendations</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Has_this_one_been_recorded_yet</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Sort_types</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Count_unchanged_recommendations</name>
        <label>Count unchanged recommendations</label>
        <locationX>578</locationX>
        <locationY>8678</locationY>
        <collectionReference>recommendations</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_this_one_updated</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Done</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Get_acceptable_recommendations</name>
        <label>Get acceptable recommendations</label>
        <locationX>578</locationX>
        <locationY>1274</locationY>
        <collectionReference>Get_all_open_recommendations</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Has_this_been_accepted_by_the_clients</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Open_product_recs</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_3_1_Filter_changeable_recs</name>
        <label>Loop 3.1 | Filter changeable recs</label>
        <locationX>578</locationX>
        <locationY>5246</locationY>
        <collectionReference>Changeable_recommendations</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Has_this_been_accepted_already</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Changeable_products_count</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_3_Recommendation_types</name>
        <label>Loop 3 | Recommendation types</label>
        <locationX>578</locationX>
        <locationY>3914</locationY>
        <collectionReference>recommendationTypes</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Acceptable_recommendations_for_this_type</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Clear_recommendation_types_variable</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_4_Recommendations_to_accept</name>
        <label>Loop 4 | Recommendations to accept</label>
        <locationX>798</locationX>
        <locationY>4238</locationY>
        <collectionReference>recsAcceptSelect.selectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_update_variables_others</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Does_the_earliest_date_accepted_need_updating_after_this_type</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_5_Recommendations_left_to_decline</name>
        <label>Loop 5 | Recommendations left to decline</label>
        <locationX>578</locationX>
        <locationY>6962</locationY>
        <collectionReference>recommendations</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Has_this_been_recorded_yet</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Loop_6_Recommendation_types_to_decline</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_6_Recommendation_types_to_decline</name>
        <label>Loop 6 | Recommendation types to decline</label>
        <locationX>578</locationX>
        <locationY>7754</locationY>
        <collectionReference>recommendationTypes</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Declineable_recommendations_of_this_type</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Count_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_7_Recommendations_of_this_type_to_decline</name>
        <label>Loop 7 | Recommendations of this type to decline</label>
        <locationX>754</locationX>
        <locationY>8078</locationY>
        <collectionReference>productDeclineSelect.selectedRows</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_to_collection7</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Loop_6_Recommendation_types_to_decline</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>Get_advice</name>
        <label>Get advice</label>
        <locationX>1018</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_earliest_decision_date</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <object>Advice__c</object>
        <outputReference>advice</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>DateAccepted__c</queriedFields>
        <queriedFields>Advice_Household__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_all_open_recommendations</name>
        <label>Get all open recommendations</label>
        <locationX>930</locationX>
        <locationY>542</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Generate_random_number</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Advice__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Awaiting decision</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Recommendation__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_advice</name>
        <label>Update advice</label>
        <locationX>446</locationX>
        <locationY>9494</locationY>
        <connector>
            <targetReference>Are_there_are_any_recommendations_outstanding</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>DateAccepted__c</field>
            <value>
                <elementReference>earliestDecisionDate</elementReference>
            </value>
        </inputAssignments>
        <object>Advice__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_new_product_recommendations</name>
        <label>Update new product recommendations</label>
        <locationX>424</locationX>
        <locationY>2606</locationY>
        <connector>
            <targetReference>Does_the_earliest_date_accepted_need_updating</targetReference>
        </connector>
        <inputReference>recsToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_recomendations</name>
        <label>Update recomendations</label>
        <locationX>578</locationX>
        <locationY>9278</locationY>
        <connector>
            <targetReference>Does_the_advice_need_updating</targetReference>
        </connector>
        <inputReference>recsToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_tasks</name>
        <label>Update tasks</label>
        <locationX>710</locationX>
        <locationY>9794</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OW_task_information_name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>chase_recommendation_acceptance</stringValue>
            </value>
        </filters>
        <filters>
            <field>WhatId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsClosed</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <inputAssignments>
            <field>OrchestrationTaskStatus__c</field>
            <value>
                <stringValue>Complete</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <object>Task</object>
    </recordUpdates>
    <runInMode>SystemModeWithSharing</runInMode>
    <screens>
        <name>Accept_open_products</name>
        <label>Accept open products</label>
        <locationX>424</locationX>
        <locationY>2090</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Accepted_new_products</targetReference>
        </connector>
        <fields>
            <name>explain1</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Select all recommendations &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;accepted&lt;/strong&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt; by the client.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>newprodAcceptSelect</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Products awaiting acceptance</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Open_product_recs</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationOverview__c&quot;,&quot;guid&quot;:&quot;column-3de1&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Recommendation details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation overview&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>DateNewProdsAccepted</name>
            <dataType>Date</dataType>
            <defaultValue>
                <elementReference>$Flow.CurrentDate</elementReference>
            </defaultValue>
            <fieldText>What date were these accepted?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Acceptance_screen</name>
        <label>Acceptance screen</label>
        <locationX>798</locationX>
        <locationY>4130</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Loop_4_Recommendations_to_accept</targetReference>
        </connector>
        <fields>
            <name>explain2</name>
            <fieldText>&lt;p&gt;If you need to update phasing or decrease the amount for a lump sum, internal transfer or withdrawal, don&#39;t accept them here - you&#39;ll be able to change them later.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Select any &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;{!Loop_3_Recommendation_types}&lt;/strong&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt; recommendations &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;accepted &lt;/strong&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;by the client.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>recsAcceptSelect</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recommendations</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Acceptable_recommendations_for_this_type</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationOverview__c&quot;,&quot;guid&quot;:&quot;column-2e08&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Recommendation details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation overview&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;NonStandardActionInstruction__c&quot;,&quot;guid&quot;:&quot;column-797a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Further details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Non-standard action instruction&quot;,&quot;type&quot;:&quot;customRichText&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>othersAccepted</name>
            <dataType>Date</dataType>
            <defaultValue>
                <elementReference>$Flow.CurrentDate</elementReference>
            </defaultValue>
            <fieldText>What date were these accepted?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Collect_change_details</name>
        <label>Collect change details</label>
        <locationX>416</locationX>
        <locationY>6386</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Assign_update_variablesChangedRecs</targetReference>
        </connector>
        <fields>
            <name>changeExplain</name>
            <fieldText>&lt;p&gt;Please provide the updated details for the following recommendation:&lt;/p&gt;&lt;p&gt;{!Changed_recommendations.RecommendationTypeName__c} to &lt;strong&gt;{!Changed_recommendations.DestinationName__c}&lt;/strong&gt; of &lt;strong&gt;{!Changed_recommendations.Amount__c}&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>newAmount</name>
            <dataType>Number</dataType>
            <defaultValue>
                <elementReference>Changed_recommendations.Amount__c</elementReference>
            </defaultValue>
            <fieldText>Amount</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;You cannot increase the amount without consulting planning. Please leave this recommendation unmarked and chatter the planner.&lt;/p&gt;</errorMessage>
                <formulaExpression>{!newAmount} &lt;= {!Changed_recommendations.Amount__c}</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>phaisngCheck</name>
            <fieldText>&lt;p&gt;REMINDER: Please consult with a planner before choosing to phase this contribution. Phasing is no longer our default process.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>new_Phasing_frequency</name>
            <choiceReferences>phasingFreqChoice</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>Changed_recommendations.PhasingFrequency__c</elementReference>
            </defaultValue>
            <fieldText>Phasing frequency</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>new_Phasing_period</name>
            <dataType>Number</dataType>
            <defaultValue>
                <elementReference>Changed_recommendations.PhasingPeriod__c</elementReference>
            </defaultValue>
            <fieldText>Phasing period</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <scale>0</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;This phasing plan involves investing less than the Hubwise minimum per month (1,000). Please decrease the phasing period appropriately.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>(
 (CONTAINS({!Changed_recommendations.Product__r.ProductType__r.ReferenceName__c} ,&quot;SIPP&quot;)) 
 &amp;&amp;
 (
   ((IF(ISPICKVAL({!Changed_recommendations.PaidBy__c},&quot;Client&quot;),1.25, 1)*{!newAmount} ) / {!new_Phasing_period}) 
   &gt;= 960
  )
)
||
(
(NOT(CONTAINS({!Changed_recommendations.Product__r.ProductType__r.ReferenceName__c}, &quot;SIPP&quot;))) 
&amp;&amp;
(({!newAmount} / {!new_Phasing_period}) &gt;= 1000)
)
||
(
ISBLANK({!Changed_recommendations.Product__c}) 
&amp;&amp;
(({!newAmount} / {!new_Phasing_period}) &gt;= 1000)
)</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>new_Phasing_frequency</leftValueReference>
                    <operator>NotEqualTo</operator>
                    <rightValue>
                        <stringValue>Single</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Declined_screen</name>
        <label>Declined screen</label>
        <locationX>754</locationX>
        <locationY>7970</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Loop_7_Recommendations_of_this_type_to_decline</targetReference>
        </connector>
        <fields>
            <name>help3</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Select any &lt;/span&gt;&lt;strong style=&quot;font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;{!Loop_6_Recommendation_types_to_decline} &lt;/strong&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;recommendations &lt;/span&gt;&lt;strong style=&quot;font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;declined&lt;/strong&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt; by the client.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>productDeclineSelect</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recommendations to decline</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Declineable_recommendations_of_this_type</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationOverview__c&quot;,&quot;guid&quot;:&quot;column-5aaf&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Recommendation details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation overview&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;NonStandardActionInstruction__c&quot;,&quot;guid&quot;:&quot;column-5afc&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Further details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Non-standard action instruction&quot;,&quot;type&quot;:&quot;customRichText&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>declinedDate</name>
            <dataType>Date</dataType>
            <defaultValue>
                <elementReference>$Flow.CurrentDate</elementReference>
            </defaultValue>
            <fieldText>What date were these declined?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Done</name>
        <label>Done</label>
        <locationX>578</locationX>
        <locationY>9170</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_recomendations</targetReference>
        </connector>
        <fields>
            <name>explain5</name>
            <fieldText>&lt;p&gt;All done - this is how it will all look:&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>reviewTable</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Data Table</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>recsToUpdate</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationOverview__c&quot;,&quot;guid&quot;:&quot;column-e7e1&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Recommendation details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation overview&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;NonStandardActionInstruction__c&quot;,&quot;guid&quot;:&quot;column-e5a9&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Further details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Non-standard action instruction&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;Status__c&quot;,&quot;guid&quot;:&quot;column-ee70&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Status&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>countNotOpen</leftValueReference>
                    <operator>GreaterThan</operator>
                    <rightValue>
                        <numberValue>0.0</numberValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>explain4</name>
            <fieldText>&lt;p&gt;There are {!count} unchanged recommendations which you will need to return to in future. &lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>unchangedDisplay</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Data Table</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>unchangedRecs</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationOverview__c&quot;,&quot;guid&quot;:&quot;column-f813&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Recommendation details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation overview&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;NonStandardActionInstruction__c&quot;,&quot;guid&quot;:&quot;column-69a2&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Further details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Non-standard action instruction&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;Status__c&quot;,&quot;guid&quot;:&quot;column-7429&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Status&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>count</leftValueReference>
                    <operator>GreaterThan</operator>
                    <rightValue>
                        <numberValue>0.0</numberValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>help4</name>
            <fieldText>&lt;p&gt;This is the last screen. Once you&#39;ve clicked next, all of the recommendations will be updated for you.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Full_acceptance_toast</name>
        <label>Full acceptance toast</label>
        <locationX>578</locationX>
        <locationY>974</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_acceptable_recommendations</targetReference>
        </connector>
        <fields>
            <name>fullAcceptanceModal</name>
            <extensionName>c:confirmModalFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Client decisions required</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>theme</name>
                <value>
                    <stringValue>warning</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>message</name>
                <value>
                    <stringValue>I will only accept or decline recommendations where the client has provided a decision. Click OK to confirm you understand and proceed.</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>navigateForwardOnConfirm</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>navigateBackOnCancel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Mark_changed_recs</name>
        <label>Mark changed recs</label>
        <locationX>436</locationX>
        <locationY>5954</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Selected_for_change_count</targetReference>
        </connector>
        <fields>
            <name>Copy_1_of_explain1</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Select any recommendations we are &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;changing &lt;/strong&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;for the client.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>changeRecs</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Recommendation__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recommendations you can change</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>changeableRecs</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;RecommendationOverview__c&quot;,&quot;guid&quot;:&quot;column-6172&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Recommendation details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Recommendation overview&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;NonStandardActionInstruction__c&quot;,&quot;guid&quot;:&quot;column-e02e&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Further details&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Non-standard action instruction&quot;,&quot;type&quot;:&quot;customRichText&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Nothing_to_do</name>
        <label>Nothing to do</label>
        <locationX>1282</locationX>
        <locationY>866</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>nothingScreen</name>
            <fieldText>&lt;p&gt;There are no recommendations left to decide on!&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>MonaSaysHi</name>
            <fieldText>&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://octopuswealth--uat.sandbox.file.force.com/sfc/servlet.shepherd/version/download/068TA000000kV5d?asPdf=false&amp;amp;operationContext=CHATTER&quot; alt=&quot;CE57D85B-E926-483C-B42B-F3146D68700C.jpeg&quot;&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Generate_random_number</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <numberValue>5.0</numberValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Partial_acceptance_toast</name>
        <label>Partial acceptance toast</label>
        <locationX>842</locationX>
        <locationY>974</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Set_someAccepted_variable</targetReference>
        </connector>
        <fields>
            <name>partialAcceptanceModal</name>
            <extensionName>c:confirmModalFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>navigateBackOnCancel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>navigateForwardOnConfirm</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue> Client decisions required</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>message</name>
                <value>
                    <stringValue>Only displaying recommendations for clients who have accepted some advice. I will only accept or decline recommendations where the client has provided a decision. Click OK to confirm you understand and proceed.</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>theme</name>
                <value>
                    <stringValue>warning</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Undecided_toast</name>
        <label>Undecided toast</label>
        <locationX>314</locationX>
        <locationY>974</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>undecidedToast</name>
            <extensionName>c:displayToastFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>message</name>
                <value>
                    <stringValue>Recommendations cannot be accepted until advice outcomes recorded</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>mode</name>
                <value>
                    <stringValue>sticky</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>title</name>
                <value>
                    <stringValue>Advice outcomes needed</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>triggerNavigationNextEvent</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>variant</name>
                <value>
                    <stringValue>error</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>804</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>HAs_advice_been_passed_in</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Call_decline_advice_flow</name>
        <label>Call decline advice flow</label>
        <locationX>50</locationX>
        <locationY>974</locationY>
        <flowName>AdviceDeclineAdvice</flowName>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <variables>
        <name>acceptedClients</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>advice</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Advice__c</objectType>
    </variables>
    <variables>
        <name>changeableRecs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>count</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>countNotOpen</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>currentItem_Acceptable_recommendations_for_this_type</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Declineable_recommendations_of_this_type</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Open_product_recs</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Other_acceptable_recommendations</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>declineableRecommendations</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>earliestDecisionDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>numAcceptedClients</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>numAdvisedClients</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>numDeclinedClients</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>progressTracker</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>recommendations</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>recommendationTypes</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recsToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>recToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <description>Records that only some of the advised clients have provided a decision.</description>
        <name>someAccepted</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>unchangedRecs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Recommendation__c</objectType>
    </variables>
    <variables>
        <name>updatedRecs</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
