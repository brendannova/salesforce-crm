<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Get_record_type_ID</name>
        <label>Get record type ID</label>
        <locationX>314</locationX>
        <locationY>1574</locationY>
        <actionName>FlowUtilityGetRecordTypeId</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Advice_method_restricted</targetReference>
        </connector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>recordTypeDeveloperName</name>
            <value>
                <elementReference>AdviceTypeSelect.firstSelectedRow.RecordTypeDeveloperName__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>sObjectType</name>
            <value>
                <stringValue>Advice__c</stringValue>
            </value>
        </inputParameters>
        <nameSegment>FlowUtilityGetRecordTypeId</nameSegment>
        <offset>0</offset>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>59.0</apiVersion>
    <assignments>
        <name>Set_advice_method</name>
        <label>Set advice method</label>
        <locationX>182</locationX>
        <locationY>1790</locationY>
        <assignmentItems>
            <assignToReference>advice.AdviceMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceTypeSelect.firstSelectedRow.AdviceMethod__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_advice_values</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_advice_values</name>
        <label>Set advice values</label>
        <locationX>314</locationX>
        <locationY>1982</locationY>
        <assignmentItems>
            <assignToReference>advice.OW_notes__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceNotes</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Subject__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_record_type_ID.recordTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Partner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>partnerDefault</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Advice_Household__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>household.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Advice_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>adviceStatusInitial</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.AdviceType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AdviceTypeSelect.firstSelectedRow.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.New_or_existing_client__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Existing</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.RtqStatus__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>rtqStatus</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.OW_review__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>reviewId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Insert_advice</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_household_ID</name>
        <label>Set household ID</label>
        <locationX>50</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>householdId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_household</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_review_flag</name>
        <label>Set review flag</label>
        <locationX>314</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>isReview</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_household</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Advice_method_restricted</name>
        <label>Advice method restricted</label>
        <locationX>314</locationX>
        <locationY>1682</locationY>
        <defaultConnector>
            <targetReference>Set_advice_values</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not restricted</defaultConnectorLabel>
        <rules>
            <name>Restricted</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>AdviceTypeSelect.firstSelectedRow.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>AdviceTypeSelect.firstSelectedRow.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>NON_PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_advice_method</targetReference>
            </connector>
            <label>Restricted</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_ongoing_advice</name>
        <label>Any ongoing advice?</label>
        <locationX>314</locationX>
        <locationY>650</locationY>
        <defaultConnector>
            <targetReference>Get_advice_types</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not found</defaultConnectorLabel>
        <rules>
            <name>Advice_found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Search_for_open_advice</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Existing_advice_check</targetReference>
            </connector>
            <label>Advice found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Created_from</name>
        <label>Created from</label>
        <locationX>314</locationX>
        <locationY>2306</locationY>
        <defaultConnector>
            <targetReference>Redirect_to_advice</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Household</defaultConnectorLabel>
        <rules>
            <name>Linked</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>isReview</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Review</label>
        </rules>
    </decisions>
    <decisions>
        <name>Launched_from</name>
        <label>Launched from</label>
        <locationX>314</locationX>
        <locationY>134</locationY>
        <defaultConnectorLabel>Unknown</defaultConnectorLabel>
        <rules>
            <name>Household_outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_household_ID</targetReference>
            </connector>
            <label>Household</label>
        </rules>
        <rules>
            <name>Review_outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>reviewId</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_review_flag</targetReference>
            </connector>
            <label>Review</label>
        </rules>
    </decisions>
    <decisions>
        <name>Warning_to_display</name>
        <label>Warning to display?</label>
        <locationX>314</locationX>
        <locationY>1166</locationY>
        <defaultConnector>
            <targetReference>Get_advice_details</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No warning</defaultConnectorLabel>
        <rules>
            <name>Warning</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AdviceTypeSelect.firstSelectedRow.Warnings__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Display_warning</targetReference>
            </connector>
            <label>Warning</label>
        </rules>
    </decisions>
    <description>Screen flow that walks a user through creating new advice.</description>
    <environments>Default</environments>
    <formulas>
        <name>adviceStatusInitial</name>
        <dataType>String</dataType>
        <expression>IF({!AdviceTypeSelect.firstSelectedRow.DeveloperName__c} = &quot;REGULAR_AMENDMENT&quot;, &quot;Prepare advice&quot;, &quot;Setup&quot;)</expression>
    </formulas>
    <formulas>
        <name>nameDefault</name>
        <dataType>String</dataType>
        <expression>{!AdviceTypeSelect.firstSelectedRow.Name} &amp; &quot; | &quot; &amp; {!household.Name}</expression>
    </formulas>
    <formulas>
        <name>partnerDefault</name>
        <dataType>String</dataType>
        <expression>CASE({!AdviceTypeSelect.firstSelectedRow.DeveloperName__c},
&quot;PROTECTION&quot;, null,
{!household.OwnerId})</expression>
    </formulas>
    <formulas>
        <name>rtqStatus</name>
        <dataType>String</dataType>
        <expression>IF(ISPICKVAL({!household.OW_rtq_status__c},&quot;Complete&quot;), &quot;No update required&quot;, IF(ISPICKVAL({!household.OW_rtq_status__c},&quot;Pending&quot;),&quot;In progress&quot;,
IF({!AdviceTypeSelect.firstSelectedRow.DeveloperName__c} = &quot;PROTECTION&quot;, &quot;&quot;, &quot;Not started&quot;)))</expression>
    </formulas>
    <interviewLabel>AdviceCreate {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Advice | Create</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Insert_advice</name>
        <label>Insert advice</label>
        <locationX>314</locationX>
        <locationY>2090</locationY>
        <connector>
            <targetReference>Success_toast</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Roll_back_changes</targetReference>
        </faultConnector>
        <inputReference>advice</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_advice_types</name>
        <label>Get advice types</label>
        <locationX>314</locationX>
        <locationY>950</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Choose_advice_type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsOnboarding__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsAnnualReview__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>isReview</elementReference>
            </value>
        </filters>
        <object>AdviceType__c</object>
        <outputReference>adviceTypes</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>Description__c</queriedFields>
        <queriedFields>RecordTypeDeveloperName__c</queriedFields>
        <queriedFields>Warnings__c</queriedFields>
        <queriedFields>DeveloperName__c</queriedFields>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_household</name>
        <label>Get household</label>
        <locationX>314</locationX>
        <locationY>434</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Search_for_open_advice</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>householdId</elementReference>
            </value>
        </filters>
        <object>Account</object>
        <outputReference>household</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>ParentId</queriedFields>
        <queriedFields>OwnerId</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>OW_rtq_status__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Search_for_open_advice</name>
        <label>Search for open advice</label>
        <locationX>314</locationX>
        <locationY>542</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Any_ongoing_advice</targetReference>
        </connector>
        <filterLogic>1 AND (2 OR 3 OR 4 OR 5 OR 6 OR 7)</filterLogic>
        <filters>
            <field>Advice_Household__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>householdId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Advice_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Setup</stringValue>
            </value>
        </filters>
        <filters>
            <field>Advice_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Data gathering</stringValue>
            </value>
        </filters>
        <filters>
            <field>Advice_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Risk Call</stringValue>
            </value>
        </filters>
        <filters>
            <field>Advice_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Ready for suitability</stringValue>
            </value>
        </filters>
        <filters>
            <field>Advice_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Suitability in progress</stringValue>
            </value>
        </filters>
        <filters>
            <field>Advice_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Prepare advice</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Advice__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordRollbacks>
        <name>Roll_back_changes</name>
        <label>Roll back changes</label>
        <locationX>842</locationX>
        <locationY>2198</locationY>
        <connector>
            <targetReference>Error_toast_and_message</targetReference>
        </connector>
    </recordRollbacks>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Choose_advice_type</name>
        <label>Choose advice type</label>
        <locationX>314</locationX>
        <locationY>1058</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Warning_to_display</targetReference>
        </connector>
        <fields>
            <name>AdviceTypeSelect</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>AdviceType__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Data Table</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>SINGLE_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>1.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>adviceTypes</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>1.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-b10e&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Advice Type Name&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Description__c&quot;,&quot;guid&quot;:&quot;column-6207&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Description&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Display_warning</name>
        <label>Display warning</label>
        <locationX>182</locationX>
        <locationY>1274</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_advice_details</targetReference>
        </connector>
        <fields>
            <name>ModalWarnings</name>
            <extensionName>c:confirmModalFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>navigateForwardOnConfirm</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>navigateBackOnCancel</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Information</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>theme</name>
                <value>
                    <stringValue>info</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>variant</name>
                <value>
                    <stringValue>header</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>message</name>
                <value>
                    <elementReference>AdviceTypeSelect.firstSelectedRow.Warnings__c</elementReference>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Error_toast_and_message</name>
        <label>Error toast and message</label>
        <locationX>842</locationX>
        <locationY>2306</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ToastError</name>
            <extensionName>c:displayToastFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>mode</name>
                <value>
                    <stringValue>dismissible</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>title</name>
                <value>
                    <stringValue>Error</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>triggerNavigationNextEvent</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>variant</name>
                <value>
                    <stringValue>error</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>Error</name>
            <fieldText>&lt;p&gt;The following error occurred. Resolve if you can or raise a ticket for support. &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;{!$Flow.FaultMessage}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Existing_advice_check</name>
        <label>Existing advice check</label>
        <locationX>182</locationX>
        <locationY>758</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_advice_types</targetReference>
        </connector>
        <fields>
            <name>existing_advice_message</name>
            <fieldText>&lt;p&gt;There is open advice already for this customer. Proceed only if you cannot combine the advice. &lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>ExistingAdvice</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>Advice__c</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Data Table</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>Search_for_open_advice</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-99fb&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Search Name&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;OW_advice_reason__c&quot;,&quot;guid&quot;:&quot;column-f061&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Advice reason&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;Advice_Status__c&quot;,&quot;guid&quot;:&quot;column-0463&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Status&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Get_advice_details</name>
        <label>Get advice details</label>
        <locationX>314</locationX>
        <locationY>1466</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_record_type_ID</targetReference>
        </connector>
        <fields>
            <name>AdviceName</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>nameDefault</elementReference>
            </defaultValue>
            <fieldText>Name</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;Be concise - 50 character limit - e.g. &lt;i&gt;Cash for investment&lt;/i&gt; or &lt;i&gt;ISA topup&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Include client(s) surname &amp;amp; ideally initial&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Examples:&lt;/p&gt;&lt;p&gt;Full review - Cockwell, S&lt;/p&gt;&lt;p&gt;Investment of cash | Cockwell, S&lt;/p&gt;</helpText>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Maximum of 50 characters&lt;/p&gt;</errorMessage>
                <formulaExpression>LEN({!AdviceName}) &lt;= 50</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>RegularAmendmentInstructions</name>
            <fieldText>&lt;p&gt;For regular amendment advice you must specify these details in the notes section:&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Whether the client requested a cancellation or reduction &lt;/li&gt;&lt;li&gt;If a reduction, by how much&lt;/li&gt;&lt;li&gt;When this amendment should take effect from&lt;/li&gt;&lt;li&gt;What method did we receive the request&lt;/li&gt;&lt;/ul&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>AdviceTypeSelect.firstSelectedRow.DeveloperName__c</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>REGULAR_AMENDMENT</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>AdviceNotes</name>
            <fieldText>Notes</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Max length 32768 characters&lt;/p&gt;</errorMessage>
                <formulaExpression>LEN({!AdviceNotes}) &lt;= 32768</formulaExpression>
            </validationRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Redirect_to_advice</name>
        <label>Redirect to advice</label>
        <locationX>446</locationX>
        <locationY>2414</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>NavigateToAdvice</name>
            <extensionName>c:recordNavigateToView</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>recordId</name>
                <value>
                    <elementReference>advice.Id</elementReference>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Success_toast</name>
        <label>Success toast</label>
        <locationX>314</locationX>
        <locationY>2198</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Created_from</targetReference>
        </connector>
        <fields>
            <name>ToastAdviceCreatedSuccess</name>
            <extensionName>c:displayToastFlow</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>mode</name>
                <value>
                    <stringValue>dismissible</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>title</name>
                <value>
                    <stringValue>Success!</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>triggerNavigationNextEvent</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>variant</name>
                <value>
                    <stringValue>success</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>message</name>
                <value>
                    <stringValue>Advice created</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>188</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Launched_from</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>advice</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>Advice__c</objectType>
    </variables>
    <variables>
        <name>adviceTypes</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>AdviceType__c</objectType>
    </variables>
    <variables>
        <description>The household for which this advice will be given</description>
        <name>household</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account</objectType>
    </variables>
    <variables>
        <description>Stores the ID of the household for which this advice will be given.</description>
        <name>householdId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>isReview</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>Sets the household ID to be the ID of the record from whose page this flow was launched.</description>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Takes the ID of a review an an input so that the advice can be linked to this on creation.</description>
        <name>reviewId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
