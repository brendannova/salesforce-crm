<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>58.0</apiVersion>
    <assignments>
        <name>Define_1st_advice_value</name>
        <label>Define 1st advice value</label>
        <locationX>248</locationX>
        <locationY>2114</locationY>
        <assignmentItems>
            <assignToReference>household.DateOfFirstAdvice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>adviceDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Review_schedule</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Define_annual_review_schedule</name>
        <label>Define annual review schedule</label>
        <locationX>248</locationX>
        <locationY>2414</locationY>
        <assignmentItems>
            <assignToReference>household.OW_annual_review_month__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>annualReviewMonth</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>household.FinServ__NextReview__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>firstAnnualReviewDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_household</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Define_household_record</name>
        <label>Define household record</label>
        <locationX>380</locationX>
        <locationY>1898</locationY>
        <assignmentItems>
            <assignToReference>household.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>household.DateOfMostRecentAdvice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>adviceDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>First_advice_decision</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_advice_expiry</name>
        <label>Set advice expiry</label>
        <locationX>380</locationX>
        <locationY>1682</locationY>
        <assignmentItems>
            <assignToReference>advice.AdviceExpiry__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>adviceExpiry</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_chase_acceptance_task</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_advice_ID</name>
        <label>Set advice ID</label>
        <locationX>380</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>adviceId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_advice</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_post_sharing_advice_values</name>
        <label>Set post-sharing advice values</label>
        <locationX>380</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>advice.AdvicePresented__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Advice_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Await decision</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Advice_method</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_presented_values_meeting_held</name>
        <label>Set presented values | meeting held</label>
        <locationX>182</locationX>
        <locationY>890</locationY>
        <assignmentItems>
            <assignToReference>advice.Suitability_meeting_status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Meeting Held</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Suitability_meeting_location__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Suitability_meeting_location</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.MeetingObserved__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>WasTheMeetingObserved</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Call_advice_recipients_flow</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_presented_values_non_presented</name>
        <label>Set presented values | non-presented</label>
        <locationX>446</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>advice.Suitability_meeting_status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Non-presented</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Suitability_meeting_location__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>N/A</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>advice.Suitability_meeting_date_time__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>clientEmailedDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Call_advice_recipients_flow</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>clientHomeChoice</name>
        <choiceText>Client&#39;s Home</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Client&#39;s Home</stringValue>
        </value>
    </choices>
    <choices>
        <name>clientWorkChoice</name>
        <choiceText>Client&#39;s Work</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Client&#39;s Work</stringValue>
        </value>
    </choices>
    <choices>
        <name>NotObserved</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </choices>
    <choices>
        <name>novaOfficeChoice</name>
        <choiceText>Nova office</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Octopus Wealth Office</stringValue>
        </value>
    </choices>
    <choices>
        <name>onlineChoice</name>
        <choiceText>Online</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Online</stringValue>
        </value>
    </choices>
    <choices>
        <name>YesObserved</name>
        <choiceText>Yes</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Yes</stringValue>
        </value>
    </choices>
    <constants>
        <name>NON_PRESENTED_VALUE</name>
        <dataType>String</dataType>
        <value>
            <stringValue>NON_PRESENTED</stringValue>
        </value>
    </constants>
    <constants>
        <name>PRESENTED_VALUE</name>
        <dataType>String</dataType>
        <value>
            <stringValue>PRESENTED</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Advice_method</name>
        <label>Advice method</label>
        <locationX>380</locationX>
        <locationY>566</locationY>
        <defaultConnectorLabel>Not defined</defaultConnectorLabel>
        <rules>
            <name>Presented_outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Confirm_meeting_details</targetReference>
            </connector>
            <label>Presented</label>
        </rules>
        <rules>
            <name>Non_presented_outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>NON_PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_presented_values_non_presented</targetReference>
            </connector>
            <label>Non-presented</label>
        </rules>
    </decisions>
    <decisions>
        <name>Decision_outcome</name>
        <label>Decision outcome</label>
        <locationX>380</locationX>
        <locationY>3254</locationY>
        <defaultConnectorLabel>All still considering</defaultConnectorLabel>
        <rules>
            <name>YesAllDeclined</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Call_advice_recipients_flow.numDeclinedClients</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Call_advice_recipients_flow.numAdvisedClients</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Call_decline_advice_flow</targetReference>
            </connector>
            <label>All recommendations declined</label>
        </rules>
        <rules>
            <name>Some_accepted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Call_advice_recipients_flow.numAcceptedClients</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Call_mark_decisions_flow</targetReference>
            </connector>
            <label>Some accepted</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_user_have_permission</name>
        <label>Does user have permission?</label>
        <locationX>1469</locationX>
        <locationY>134</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Permission.AdviceConfirmPresentation</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_advice_ID</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>First_advice_decision</name>
        <label>First advice?</label>
        <locationX>380</locationX>
        <locationY>2006</locationY>
        <defaultConnector>
            <targetReference>Review_schedule</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not first advice</defaultConnectorLabel>
        <rules>
            <name>First_advice_outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.Advice_Household__r.DateOfFirstAdvice__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Define_1st_advice_value</targetReference>
            </connector>
            <label>First advice</label>
        </rules>
    </decisions>
    <decisions>
        <description>If the partner has selected that the advice was presented, the advice must have a meeting event attached</description>
        <name>Meeting_needs_to_be_added</name>
        <label>Meeting needs to be added?</label>
        <locationX>50</locationX>
        <locationY>782</locationY>
        <defaultConnector>
            <targetReference>Set_presented_values_meeting_held</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No action needed</defaultConnectorLabel>
        <rules>
            <name>Needs_to_be_added</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.Suitability_meeting_date_time__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Needs to be added</label>
        </rules>
    </decisions>
    <decisions>
        <name>Presented_Method</name>
        <label>Presented Method</label>
        <locationX>380</locationX>
        <locationY>1274</locationY>
        <defaultConnector>
            <targetReference>Set_advice_expiry</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not defined</defaultConnectorLabel>
        <rules>
            <name>Meeting</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.AdviceMethod__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PRESENTED</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_send_dropbox_task</targetReference>
            </connector>
            <label>Meeting</label>
        </rules>
    </decisions>
    <decisions>
        <name>Review_schedule</name>
        <label>Review schedule</label>
        <locationX>380</locationX>
        <locationY>2306</locationY>
        <defaultConnector>
            <targetReference>Update_household</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Already defined</defaultConnectorLabel>
        <rules>
            <name>Review_scheduled_needed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>advice.Advice_Household__r.OW_annual_review_month__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Define_annual_review_schedule</targetReference>
            </connector>
            <label>Review scheduled needed</label>
        </rules>
    </decisions>
    <description>Allows the user to confirm that advice has been presented while also providing details on how.</description>
    <dynamicChoiceSets>
        <name>adviceMethodChoice</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true" />
        <object xsi:nil="true" />
        <picklistField>AdviceMethod__c</picklistField>
        <picklistObject>Advice__c</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <description>The date value of the suitability meeting date/time.</description>
        <name>adviceDate</name>
        <dataType>Date</dataType>
        <expression>DATEVALUE({!advice.Suitability_meeting_date_time__c})</expression>
    </formulas>
    <formulas>
        <description>The date on which the advice expires.</description>
        <name>adviceExpiry</name>
        <dataType>Date</dataType>
        <expression>ADDMONTHS(DATEVALUE({!advice.Suitability_meeting_date_time__c}),3)</expression>
    </formulas>
    <formulas>
        <description>The month in which the customer should get their annual review.</description>
        <name>annualReviewMonth</name>
        <dataType>String</dataType>
        <expression>IF(MONTH({!adviceDate}) != 3, TEXT(MONTH({!adviceDate})), IF(DAY({!adviceDate}) &lt;= 16, &quot;1&quot;, &quot;2&quot;))</expression>
    </formulas>
    <formulas>
        <description>The date of the customer&#39;s 1st annual review.</description>
        <name>firstAnnualReviewDate</name>
        <dataType>Date</dataType>
        <expression>DATE(YEAR({!adviceDate}) + 1, VALUE({!annualReviewMonth}), 1)</expression>
    </formulas>
    <formulas>
        <name>presented</name>
        <dataType>Boolean</dataType>
        <expression>ISPICKVAL({!advice.AdviceMethod__c}, &quot;Presented&quot;)</expression>
    </formulas>
    <interviewLabel>Advice | Confirm Presented {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Advice | Confirm Presented</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_advice_recipients</name>
        <label>Create advice recipients</label>
        <locationX>380</locationX>
        <locationY>2822</locationY>
        <connector>
            <targetReference>Close_task</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Roll_back</targetReference>
        </faultConnector>
        <inputReference>Call_advice_recipients_flow.adviceRecipients</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_advice</name>
        <label>Get advice</label>
        <locationX>380</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_post_sharing_advice_values</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>adviceId</elementReference>
            </value>
        </filters>
        <object>Advice__c</object>
        <outputReference>advice</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Suitability_meeting_location__c</queriedFields>
        <queriedFields>Suitability_meeting_date_time__c</queriedFields>
        <queriedFields>Suitability_meeting_status__c</queriedFields>
        <queriedFields>AdvicePresented__c</queriedFields>
        <queriedFields>Advice_Household__c</queriedFields>
        <queriedFields>DateAccepted__c</queriedFields>
        <queriedFields>AdviceMethod__c</queriedFields>
    </recordLookups>
    <recordRollbacks>
        <name>Roll_back</name>
        <label>Roll back</label>
        <locationX>2030</locationX>
        <locationY>2822</locationY>
        <connector>
            <targetReference>Fault_Screen</targetReference>
        </connector>
    </recordRollbacks>
    <recordUpdates>
        <name>Close_task</name>
        <label>Close task</label>
        <locationX>380</locationX>
        <locationY>2930</locationY>
        <connector>
            <targetReference>Update_recommendations</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Roll_back</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>WhatId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>OW_task_information_name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>confirm_meeting</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>OrchestrationTaskStatus__c</field>
            <value>
                <stringValue>Complete</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <object>Task</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_advice</name>
        <label>Update advice</label>
        <locationX>380</locationX>
        <locationY>2714</locationY>
        <connector>
            <targetReference>Create_advice_recipients</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Roll_back</targetReference>
        </faultConnector>
        <inputReference>advice</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_fees</name>
        <label>Update fees</label>
        <locationX>380</locationX>
        <locationY>3146</locationY>
        <connector>
            <targetReference>Decision_outcome</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Roll_back</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </filters>
        <filters>
            <field>Advice__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Await decision</stringValue>
            </value>
        </inputAssignments>
        <object>Fee__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_household</name>
        <label>Update household</label>
        <locationX>380</locationX>
        <locationY>2606</locationY>
        <connector>
            <targetReference>Update_advice</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Roll_back</targetReference>
        </faultConnector>
        <inputReference>household</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_recommendations</name>
        <label>Update recommendations</label>
        <locationX>380</locationX>
        <locationY>3038</locationY>
        <connector>
            <targetReference>Update_fees</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Roll_back</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Advice__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Awaiting decision</stringValue>
            </value>
        </inputAssignments>
        <object>Recommendation__c</object>
    </recordUpdates>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Confirm_meeting_details</name>
        <label>Confirm meeting details</label>
        <locationX>50</locationX>
        <locationY>674</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Meeting_needs_to_be_added</targetReference>
        </connector>
        <fields>
            <name>adviceMethod</name>
            <choiceReferences>adviceMethodChoice</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>advice.AdviceMethod__c</elementReference>
            </defaultValue>
            <fieldText>How was the advice shared with the customer?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isDisabled>
                <booleanValue>true</booleanValue>
            </isDisabled>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>NoMeetingDateTimeError</name>
            <fieldText>&lt;p&gt;There was an advice meeting but this has not been recorded on the advice. Please close this pop up and add the advice meeting manually.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Once you have done that and confirmed the date/time of the meeting, you can run this wizard again.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://octopuswealth.file.force.com/sfc/servlet.shepherd/version/download/068Sl000000qqAc?asPdf=false&amp;amp;operationContext=CHATTER&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>advice.Suitability_meeting_date_time__c</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Suitability_meeting_location</name>
            <choiceReferences>onlineChoice</choiceReferences>
            <choiceReferences>novaOfficeChoice</choiceReferences>
            <choiceReferences>clientWorkChoice</choiceReferences>
            <choiceReferences>clientHomeChoice</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>advice.Suitability_meeting_location__c</elementReference>
            </defaultValue>
            <fieldText>Confirm suitability meeting location</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>advice.Suitability_meeting_date_time__c</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>WasTheMeetingObserved</name>
            <choiceReferences>YesObserved</choiceReferences>
            <choiceReferences>NotObserved</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Was the meeting observed?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>advice.Suitability_meeting_date_time__c</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Fault_Screen</name>
        <label>Fault Screen</label>
        <locationX>2030</locationX>
        <locationY>2930</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>FaultMessage</name>
            <fieldText>&lt;p&gt;An error has occurred. Please resolve yourself if you can or raise a ticket. &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;{!$Flow.FaultMessage}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>1343</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Does_user_have_permission</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <description>Calls the flow which creates advice recipient records and returns the numbers of clients who have been advised and accepted. If it determines that all advice was declined, the declined flow will be called from there.</description>
        <name>Call_advice_recipients_flow</name>
        <label>Call advice recipients flow</label>
        <locationX>380</locationX>
        <locationY>1166</locationY>
        <connector>
            <targetReference>Presented_Method</targetReference>
        </connector>
        <flowName>AdviceRecipientsCreateAndUpdate</flowName>
        <inputAssignments>
            <name>advice</name>
            <value>
                <elementReference>advice</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>adviceId</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>calledFromAdviceConfirmation</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>recipientConfirmationNeeded</name>
            <value>
                <elementReference>presented</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Call_decline_advice_flow</name>
        <label>Call decline advice flow</label>
        <locationX>116</locationX>
        <locationY>3362</locationY>
        <flowName>AdviceDeclineAdvice</flowName>
        <inputAssignments>
            <name>advice</name>
            <value>
                <elementReference>advice</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>If the advice recipients flow determined that some advice has been accepted, the record decisions sub flow is called for these to be marked.</description>
        <name>Call_mark_decisions_flow</name>
        <label>Call mark decisions flow</label>
        <locationX>380</locationX>
        <locationY>3362</locationY>
        <flowName>RecommendationsRecordDecisions</flowName>
        <inputAssignments>
            <name>acceptedClients</name>
            <value>
                <elementReference>Call_advice_recipients_flow.acceptedClients</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>advice</name>
            <value>
                <elementReference>advice</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>numAcceptedClients</name>
            <value>
                <elementReference>Call_advice_recipients_flow.numAcceptedClients</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>numAdvisedClients</name>
            <value>
                <elementReference>Call_advice_recipients_flow.numAdvisedClients</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>numDeclinedClients</name>
            <value>
                <elementReference>Call_advice_recipients_flow.numDeclinedClients</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Create_chase_acceptance_task</name>
        <label>Create chase acceptance task</label>
        <locationX>380</locationX>
        <locationY>1790</locationY>
        <connector>
            <targetReference>Define_household_record</targetReference>
        </connector>
        <flowName>OW_task_create_from_task_information</flowName>
        <inputAssignments>
            <name>household_id</name>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>related_advice_id</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>task_type</name>
            <value>
                <stringValue>chase_recommendation_acceptance</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>what_id</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Create_send_dropbox_task</name>
        <label>Create send dropbox task</label>
        <locationX>248</locationX>
        <locationY>1382</locationY>
        <connector>
            <targetReference>Create_suitability_meeting_debrief_task</targetReference>
        </connector>
        <flowName>OW_task_create_from_task_information</flowName>
        <inputAssignments>
            <name>household_id</name>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>related_advice_id</name>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>task_type</name>
            <value>
                <stringValue>PORTAL_DOCS_UPLOAD</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>what_id</name>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Create_suitability_meeting_debrief_task</name>
        <label>Create suitability meeting debrief task</label>
        <locationX>248</locationX>
        <locationY>1490</locationY>
        <connector>
            <targetReference>Set_advice_expiry</targetReference>
        </connector>
        <flowName>OW_task_create_from_task_information</flowName>
        <inputAssignments>
            <name>household_id</name>
            <value>
                <elementReference>advice.Advice_Household__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>related_advice_id</name>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>task_type</name>
            <value>
                <stringValue>Advice_Meeting_debrief</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>what_id</name>
            <value>
                <elementReference>advice.Id</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>advice</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Advice__c</objectType>
    </variables>
    <variables>
        <name>adviceId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>clientEmailedDateTime</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>household</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
